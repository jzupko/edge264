// TODO: Mbaff must update ref_idx_mask each time it decodes mb_field_decoding_flag.
// TODO: Beware that signed division cannot be vectorised as a mere shift.
// TODO: Apply the update of mvs pointers at each macroblock.
// TODO: Remove all uses of bare unsigned/int in favor of fixed sizes.

#include "edge264_common.h"

// cabac_init_idc==0 for I frames.
static const int8_t context_init[4][1024][2] __attribute__((aligned(16))) = {{
	{  20, -15}, {   2,  54}, {   3,  74}, {  20, -15}, {   2,  54}, {   3,  74},
	{ -28, 127}, { -23, 104}, {  -6,  53}, {  -1,  54}, {   7,  51}, {   0,   0},
	{   0,   0}, {   0,   0}, {   0,   0}, {   0,   0}, {   0,   0}, {   0,   0},
	{   0,   0}, {   0,   0}, {   0,   0}, {   0,   0}, {   0,   0}, {   0,   0},
	{   0,   0}, {   0,   0}, {   0,   0}, {   0,   0}, {   0,   0}, {   0,   0},
	{   0,   0}, {   0,   0}, {   0,   0}, {   0,   0}, {   0,   0}, {   0,   0},
	{   0,   0}, {   0,   0}, {   0,   0}, {   0,   0}, {   0,   0}, {   0,   0},
	{   0,   0}, {   0,   0}, {   0,   0}, {   0,   0}, {   0,   0}, {   0,   0},
	{   0,   0}, {   0,   0}, {   0,   0}, {   0,   0}, {   0,   0}, {   0,   0},
	{   0,   0}, {   0,   0}, {   0,   0}, {   0,   0}, {   0,   0}, {   0,   0},
	{   0,  41}, {   0,  63}, {   0,  63}, {   0,  63}, {  -9,  83}, {   4,  86},
	{   0,  97}, {  -7,  72}, {  13,  41}, {   3,  62}, {   0,  11}, {   1,  55},
	{   0,  69}, { -17, 127}, { -13, 102}, {   0,  82}, {  -7,  74}, { -21, 107},
	{ -27, 127}, { -31, 127}, { -24, 127}, { -18,  95}, { -27, 127}, { -21, 114},
	{ -30, 127}, { -17, 123}, { -12, 115}, { -16, 122}, { -11, 115}, { -12,  63},
	{  -2,  68}, { -15,  84}, { -13, 104}, {  -3,  70}, {  -8,  93}, { -10,  90},
	{ -30, 127}, {  -1,  74}, {  -6,  97}, {  -7,  91}, { -20, 127}, {  -4,  56},
	{  -5,  82}, {  -7,  76}, { -22, 125}, {  -7,  93}, { -11,  87}, {  -3,  77},
	{  -5,  71}, {  -4,  63}, {  -4,  68}, { -12,  84}, {  -7,  62}, {  -7,  65},
	{   8,  61}, {   5,  56}, {  -2,  66}, {   1,  64}, {   0,  61}, {  -2,  78},
	{   1,  50}, {   7,  52}, {  10,  35}, {   0,  44}, {  11,  38}, {   1,  45},
	{   0,  46}, {   5,  44}, {  31,  17}, {   1,  51}, {   7,  50}, {  28,  19},
	{  16,  33}, {  14,  62}, { -13, 108}, { -15, 100}, { -13, 101}, { -13,  91},
	{ -12,  94}, { -10,  88}, { -16,  84}, { -10,  86}, {  -7,  83}, { -13,  87},
	{ -19,  94}, {   1,  70}, {   0,  72}, {  -5,  74}, {  18,  59}, {  -8, 102},
	{ -15, 100}, {   0,  95}, {  -4,  75}, {   2,  72}, { -11,  75}, {  -3,  71},
	{  15,  46}, { -13,  69}, {   0,  62}, {   0,  65}, {  21,  37}, { -15,  72},
	{   9,  57}, {  16,  54}, {   0,  62}, {  12,  72}, {  24,   0}, {  15,   9},
	{   8,  25}, {  13,  18}, {  15,   9}, {  13,  19}, {  10,  37}, {  12,  18},
	{   6,  29}, {  20,  33}, {  15,  30}, {   4,  45}, {   1,  58}, {   0,  62},
	{   7,  61}, {  12,  38}, {  11,  45}, {  15,  39}, {  11,  42}, {  13,  44},
	{  16,  45}, {  12,  41}, {  10,  49}, {  30,  34}, {  18,  42}, {  10,  55},
	{  17,  51}, {  17,  46}, {   0,  89}, {  26, -19}, {  22, -17}, {  26, -17},
	{  30, -25}, {  28, -20}, {  33, -23}, {  37, -27}, {  33, -23}, {  40, -28},
	{  38, -17}, {  33, -11}, {  40, -15}, {  41,  -6}, {  38,   1}, {  41,  17},
	{  30,  -6}, {  27,   3}, {  26,  22}, {  37, -16}, {  35,  -4}, {  38,  -8},
	{  38,  -3}, {  37,   3}, {  38,   5}, {  42,   0}, {  35,  16}, {  39,  22},
	{  14,  48}, {  27,  37}, {  21,  60}, {  12,  68}, {   2,  97}, {  -3,  71},
	{  -6,  42}, {  -5,  50}, {  -3,  54}, {  -2,  62}, {   0,  58}, {   1,  63},
	{  -2,  72}, {  -1,  74}, {  -9,  91}, {  -5,  67}, {  -5,  27}, {  -3,  39},
	{  -2,  44}, {   0,  46}, { -16,  64}, {  -8,  68}, { -10,  78}, {  -6,  77},
	{ -10,  86}, { -12,  92}, { -15,  55}, { -10,  60}, {  -6,  62}, {  -4,  65},
	{ -12,  73}, {  -8,  76}, {  -7,  80}, {  -9,  88}, { -17, 110}, { -11,  97},
	{ -20,  84}, { -11,  79}, {  -6,  73}, {  -4,  74}, { -13,  86}, { -13,  96},
	{ -11,  97}, { -19, 117}, {  -8,  78}, {  -5,  33}, {  -4,  48}, {  -2,  53},
	{  -3,  62}, { -13,  71}, { -10,  79}, { -12,  86}, { -13,  90}, { -14,  97},
	{   0,   0}, {  -6,  93}, {  -6,  84}, {  -8,  79}, {   0,  66}, {  -1,  71},
	{   0,  62}, {  -2,  60}, {  -2,  59}, {  -5,  75}, {  -3,  62}, {  -4,  58},
	{  -9,  66}, {  -1,  79}, {   0,  71}, {   3,  68}, {  10,  44}, {  -7,  62},
	{  15,  36}, {  14,  40}, {  16,  27}, {  12,  29}, {   1,  44}, {  20,  36},
	{  18,  32}, {   5,  42}, {   1,  48}, {  10,  62}, {  17,  46}, {   9,  64},
	{ -12, 104}, { -11,  97}, { -16,  96}, {  -7,  88}, {  -8,  85}, {  -7,  85},
	{  -9,  85}, { -13,  88}, {   4,  66}, {  -3,  77}, {  -3,  76}, {  -6,  76},
	{  10,  58}, {  -1,  76}, {  -1,  83}, {  -7,  99}, { -14,  95}, {   2,  95},
	{   0,  76}, {  -5,  74}, {   0,  70}, { -11,  75}, {   1,  68}, {   0,  65},
	{ -14,  73}, {   3,  62}, {   4,  62}, {  -1,  68}, { -13,  75}, {  11,  55},
	{   5,  64}, {  12,  70}, {  15,   6}, {   6,  19}, {   7,  16}, {  12,  14},
	{  18,  13}, {  13,  11}, {  13,  15}, {  15,  16}, {  12,  23}, {  13,  23},
	{  15,  20}, {  14,  26}, {  14,  44}, {  17,  40}, {  17,  47}, {  24,  17},
	{  21,  21}, {  25,  22}, {  31,  27}, {  22,  29}, {  19,  35}, {  14,  50},
	{  10,  57}, {   7,  63}, {  -2,  77}, {  -4,  82}, {  -3,  94}, {   9,  69},
	{ -12, 109}, {  36, -35}, {  36, -34}, {  32, -26}, {  37, -30}, {  44, -32},
	{  34, -18}, {  34, -15}, {  40, -15}, {  33,  -7}, {  35,  -5}, {  33,   0},
	{  38,   2}, {  33,  13}, {  23,  35}, {  13,  58}, {  29,  -3}, {  26,   0},
	{  22,  30}, {  31,  -7}, {  35, -15}, {  34,  -3}, {  34,   3}, {  36,  -1},
	{  34,   5}, {  32,  11}, {  35,   5}, {  34,  12}, {  39,  11}, {  30,  29},
	{  34,  26}, {  29,  39}, {  19,  66}, {  31,  21}, {  31,  31}, {  25,  50},
	{ -17, 120}, { -20, 112}, { -18, 114}, { -11,  85}, { -15,  92}, { -14,  89},
	{ -26,  71}, { -15,  81}, { -14,  80}, {   0,  68}, { -14,  70}, { -24,  56},
	{ -23,  68}, { -24,  50}, { -11,  74}, {  23, -13}, {  26, -13}, {  40, -15},
	{  49, -14}, {  44,   3}, {  45,   6}, {  44,  34}, {  33,  54}, {  19,  82},
	{  -3,  75}, {  -1,  23}, {   1,  34}, {   1,  43}, {   0,  54}, {  -2,  55},
	{   0,  61}, {   1,  64}, {   0,  68}, {  -9,  92}, { -14, 106}, { -13,  97},
	{ -15,  90}, { -12,  90}, { -18,  88}, { -10,  73}, {  -9,  79}, { -14,  86},
	{ -10,  73}, { -10,  70}, { -10,  69}, {  -5,  66}, {  -9,  64}, {  -5,  58},
	{   2,  59}, {  21, -10}, {  24, -11}, {  28,  -8}, {  28,  -1}, {  29,   3},
	{  29,   9}, {  35,  20}, {  29,  36}, {  14,  67}, { -17, 123}, { -12, 115},
	{ -16, 122}, { -11, 115}, { -12,  63}, {  -2,  68}, { -15,  84}, { -13, 104},
	{  -3,  70}, {  -8,  93}, { -10,  90}, { -30, 127}, { -17, 123}, { -12, 115},
	{ -16, 122}, { -11, 115}, { -12,  63}, {  -2,  68}, { -15,  84}, { -13, 104},
	{  -3,  70}, {  -8,  93}, { -10,  90}, { -30, 127}, {  -7,  93}, { -11,  87},
	{  -3,  77}, {  -5,  71}, {  -4,  63}, {  -4,  68}, { -12,  84}, {  -7,  62},
	{  -7,  65}, {   8,  61}, {   5,  56}, {  -2,  66}, {   1,  64}, {   0,  61},
	{  -2,  78}, {   1,  50}, {   7,  52}, {  10,  35}, {   0,  44}, {  11,  38},
	{   1,  45}, {   0,  46}, {   5,  44}, {  31,  17}, {   1,  51}, {   7,  50},
	{  28,  19}, {  16,  33}, {  14,  62}, { -13, 108}, { -15, 100}, { -13, 101},
	{ -13,  91}, { -12,  94}, { -10,  88}, { -16,  84}, { -10,  86}, {  -7,  83},
	{ -13,  87}, { -19,  94}, {   1,  70}, {   0,  72}, {  -5,  74}, {  18,  59},
	{  -7,  93}, { -11,  87}, {  -3,  77}, {  -5,  71}, {  -4,  63}, {  -4,  68},
	{ -12,  84}, {  -7,  62}, {  -7,  65}, {   8,  61}, {   5,  56}, {  -2,  66},
	{   1,  64}, {   0,  61}, {  -2,  78}, {   1,  50}, {   7,  52}, {  10,  35},
	{   0,  44}, {  11,  38}, {   1,  45}, {   0,  46}, {   5,  44}, {  31,  17},
	{   1,  51}, {   7,  50}, {  28,  19}, {  16,  33}, {  14,  62}, { -13, 108},
	{ -15, 100}, { -13, 101}, { -13,  91}, { -12,  94}, { -10,  88}, { -16,  84},
	{ -10,  86}, {  -7,  83}, { -13,  87}, { -19,  94}, {   1,  70}, {   0,  72},
	{  -5,  74}, {  18,  59}, {  24,   0}, {  15,   9}, {   8,  25}, {  13,  18},
	{  15,   9}, {  13,  19}, {  10,  37}, {  12,  18}, {   6,  29}, {  20,  33},
	{  15,  30}, {   4,  45}, {   1,  58}, {   0,  62}, {   7,  61}, {  12,  38},
	{  11,  45}, {  15,  39}, {  11,  42}, {  13,  44}, {  16,  45}, {  12,  41},
	{  10,  49}, {  30,  34}, {  18,  42}, {  10,  55}, {  17,  51}, {  17,  46},
	{   0,  89}, {  26, -19}, {  22, -17}, {  26, -17}, {  30, -25}, {  28, -20},
	{  33, -23}, {  37, -27}, {  33, -23}, {  40, -28}, {  38, -17}, {  33, -11},
	{  40, -15}, {  41,  -6}, {  38,   1}, {  41,  17}, {  24,   0}, {  15,   9},
	{   8,  25}, {  13,  18}, {  15,   9}, {  13,  19}, {  10,  37}, {  12,  18},
	{   6,  29}, {  20,  33}, {  15,  30}, {   4,  45}, {   1,  58}, {   0,  62},
	{   7,  61}, {  12,  38}, {  11,  45}, {  15,  39}, {  11,  42}, {  13,  44},
	{  16,  45}, {  12,  41}, {  10,  49}, {  30,  34}, {  18,  42}, {  10,  55},
	{  17,  51}, {  17,  46}, {   0,  89}, {  26, -19}, {  22, -17}, {  26, -17},
	{  30, -25}, {  28, -20}, {  33, -23}, {  37, -27}, {  33, -23}, {  40, -28},
	{  38, -17}, {  33, -11}, {  40, -15}, {  41,  -6}, {  38,   1}, {  41,  17},
	{ -17, 120}, { -20, 112}, { -18, 114}, { -11,  85}, { -15,  92}, { -14,  89},
	{ -26,  71}, { -15,  81}, { -14,  80}, {   0,  68}, { -14,  70}, { -24,  56},
	{ -23,  68}, { -24,  50}, { -11,  74}, { -14, 106}, { -13,  97}, { -15,  90},
	{ -12,  90}, { -18,  88}, { -10,  73}, {  -9,  79}, { -14,  86}, { -10,  73},
	{ -10,  70}, { -10,  69}, {  -5,  66}, {  -9,  64}, {  -5,  58}, {   2,  59},
	{  23, -13}, {  26, -13}, {  40, -15}, {  49, -14}, {  44,   3}, {  45,   6},
	{  44,  34}, {  33,  54}, {  19,  82}, {  21, -10}, {  24, -11}, {  28,  -8},
	{  28,  -1}, {  29,   3}, {  29,   9}, {  35,  20}, {  29,  36}, {  14,  67},
	{  -3,  75}, {  -1,  23}, {   1,  34}, {   1,  43}, {   0,  54}, {  -2,  55},
	{   0,  61}, {   1,  64}, {   0,  68}, {  -9,  92}, { -17, 120}, { -20, 112},
	{ -18, 114}, { -11,  85}, { -15,  92}, { -14,  89}, { -26,  71}, { -15,  81},
	{ -14,  80}, {   0,  68}, { -14,  70}, { -24,  56}, { -23,  68}, { -24,  50},
	{ -11,  74}, { -14, 106}, { -13,  97}, { -15,  90}, { -12,  90}, { -18,  88},
	{ -10,  73}, {  -9,  79}, { -14,  86}, { -10,  73}, { -10,  70}, { -10,  69},
	{  -5,  66}, {  -9,  64}, {  -5,  58}, {   2,  59}, {  23, -13}, {  26, -13},
	{  40, -15}, {  49, -14}, {  44,   3}, {  45,   6}, {  44,  34}, {  33,  54},
	{  19,  82}, {  21, -10}, {  24, -11}, {  28,  -8}, {  28,  -1}, {  29,   3},
	{  29,   9}, {  35,  20}, {  29,  36}, {  14,  67}, {  -3,  75}, {  -1,  23},
	{   1,  34}, {   1,  43}, {   0,  54}, {  -2,  55}, {   0,  61}, {   1,  64},
	{   0,  68}, {  -9,  92}, {  -6,  93}, {  -6,  84}, {  -8,  79}, {   0,  66},
	{  -1,  71}, {   0,  62}, {  -2,  60}, {  -2,  59}, {  -5,  75}, {  -3,  62},
	{  -4,  58}, {  -9,  66}, {  -1,  79}, {   0,  71}, {   3,  68}, {  10,  44},
	{  -7,  62}, {  15,  36}, {  14,  40}, {  16,  27}, {  12,  29}, {   1,  44},
	{  20,  36}, {  18,  32}, {   5,  42}, {   1,  48}, {  10,  62}, {  17,  46},
	{   9,  64}, { -12, 104}, { -11,  97}, { -16,  96}, {  -7,  88}, {  -8,  85},
	{  -7,  85}, {  -9,  85}, { -13,  88}, {   4,  66}, {  -3,  77}, {  -3,  76},
	{  -6,  76}, {  10,  58}, {  -1,  76}, {  -1,  83}, {  -6,  93}, {  -6,  84},
	{  -8,  79}, {   0,  66}, {  -1,  71}, {   0,  62}, {  -2,  60}, {  -2,  59},
	{  -5,  75}, {  -3,  62}, {  -4,  58}, {  -9,  66}, {  -1,  79}, {   0,  71},
	{   3,  68}, {  10,  44}, {  -7,  62}, {  15,  36}, {  14,  40}, {  16,  27},
	{  12,  29}, {   1,  44}, {  20,  36}, {  18,  32}, {   5,  42}, {   1,  48},
	{  10,  62}, {  17,  46}, {   9,  64}, { -12, 104}, { -11,  97}, { -16,  96},
	{  -7,  88}, {  -8,  85}, {  -7,  85}, {  -9,  85}, { -13,  88}, {   4,  66},
	{  -3,  77}, {  -3,  76}, {  -6,  76}, {  10,  58}, {  -1,  76}, {  -1,  83},
	{  15,   6}, {   6,  19}, {   7,  16}, {  12,  14}, {  18,  13}, {  13,  11},
	{  13,  15}, {  15,  16}, {  12,  23}, {  13,  23}, {  15,  20}, {  14,  26},
	{  14,  44}, {  17,  40}, {  17,  47}, {  24,  17}, {  21,  21}, {  25,  22},
	{  31,  27}, {  22,  29}, {  19,  35}, {  14,  50}, {  10,  57}, {   7,  63},
	{  -2,  77}, {  -4,  82}, {  -3,  94}, {   9,  69}, { -12, 109}, {  36, -35},
	{  36, -34}, {  32, -26}, {  37, -30}, {  44, -32}, {  34, -18}, {  34, -15},
	{  40, -15}, {  33,  -7}, {  35,  -5}, {  33,   0}, {  38,   2}, {  33,  13},
	{  23,  35}, {  13,  58}, {  15,   6}, {   6,  19}, {   7,  16}, {  12,  14},
	{  18,  13}, {  13,  11}, {  13,  15}, {  15,  16}, {  12,  23}, {  13,  23},
	{  15,  20}, {  14,  26}, {  14,  44}, {  17,  40}, {  17,  47}, {  24,  17},
	{  21,  21}, {  25,  22}, {  31,  27}, {  22,  29}, {  19,  35}, {  14,  50},
	{  10,  57}, {   7,  63}, {  -2,  77}, {  -4,  82}, {  -3,  94}, {   9,  69},
	{ -12, 109}, {  36, -35}, {  36, -34}, {  32, -26}, {  37, -30}, {  44, -32},
	{  34, -18}, {  34, -15}, {  40, -15}, {  33,  -7}, {  35,  -5}, {  33,   0},
	{  38,   2}, {  33,  13}, {  23,  35}, {  13,  58}, {  -3,  71}, {  -6,  42},
	{  -5,  50}, {  -3,  54}, {  -2,  62}, {   0,  58}, {   1,  63}, {  -2,  72},
	{  -1,  74}, {  -9,  91}, {  -5,  67}, {  -5,  27}, {  -3,  39}, {  -2,  44},
	{   0,  46}, { -16,  64}, {  -8,  68}, { -10,  78}, {  -6,  77}, { -10,  86},
	{ -12,  92}, { -15,  55}, { -10,  60}, {  -6,  62}, {  -4,  65}, { -12,  73},
	{  -8,  76}, {  -7,  80}, {  -9,  88}, { -17, 110}, {  -3,  71}, {  -6,  42},
	{  -5,  50}, {  -3,  54}, {  -2,  62}, {   0,  58}, {   1,  63}, {  -2,  72},
	{  -1,  74}, {  -9,  91}, {  -5,  67}, {  -5,  27}, {  -3,  39}, {  -2,  44},
	{   0,  46}, { -16,  64}, {  -8,  68}, { -10,  78}, {  -6,  77}, { -10,  86},
	{ -12,  92}, { -15,  55}, { -10,  60}, {  -6,  62}, {  -4,  65}, { -12,  73},
	{  -8,  76}, {  -7,  80}, {  -9,  88}, { -17, 110}, {  -3,  70}, {  -8,  93},
	{ -10,  90}, { -30, 127}, {  -3,  70}, {  -8,  93}, { -10,  90}, { -30, 127},
	{  -3,  70}, {  -8,  93}, { -10,  90}, { -30, 127},
	}, {
	{  20, -15}, {   2,  54}, {   3,  74}, {  20, -15}, {   2,  54}, {   3,  74},
	{ -28, 127}, { -23, 104}, {  -6,  53}, {  -1,  54}, {   7,  51}, {  23,  33},
	{  23,   2}, {  21,   0}, {   1,   9}, {   0,  49}, { -37, 118}, {   5,  57},
	{ -13,  78}, { -11,  65}, {   1,  62}, {  12,  49}, {  -4,  73}, {  17,  50},
	{  18,  64}, {   9,  43}, {  29,   0}, {  26,  67}, {  16,  90}, {   9, 104},
	{ -46, 127}, { -20, 104}, {   1,  67}, { -13,  78}, { -11,  65}, {   1,  62},
	{  -6,  86}, { -17,  95}, {  -6,  61}, {   9,  45}, {  -3,  69}, {  -6,  81},
	{ -11,  96}, {   6,  55}, {   7,  67}, {  -5,  86}, {   2,  88}, {   0,  58},
	{  -3,  76}, { -10,  94}, {   5,  54}, {   4,  69}, {  -3,  81}, {   0,  88},
	{  -7,  67}, {  -5,  74}, {  -4,  74}, {  -5,  80}, {  -7,  72}, {   1,  58},
	{   0,  41}, {   0,  63}, {   0,  63}, {   0,  63}, {  -9,  83}, {   4,  86},
	{   0,  97}, {  -7,  72}, {  13,  41}, {   3,  62}, {   0,  45}, {  -4,  78},
	{  -3,  96}, { -27, 126}, { -28,  98}, { -25, 101}, { -23,  67}, { -28,  82},
	{ -20,  94}, { -16,  83}, { -22, 110}, { -21,  91}, { -18, 102}, { -13,  93},
	{ -29, 127}, {  -7,  92}, {  -5,  89}, {  -7,  96}, { -13, 108}, {  -3,  46},
	{  -1,  65}, {  -1,  57}, {  -9,  93}, {  -3,  74}, {  -9,  92}, {  -8,  87},
	{ -23, 126}, {   5,  54}, {   6,  60}, {   6,  59}, {   6,  69}, {  -1,  48},
	{   0,  68}, {  -4,  69}, {  -8,  88}, {  -2,  85}, {  -6,  78}, {  -1,  75},
	{  -7,  77}, {   2,  54}, {   5,  50}, {  -3,  68}, {   1,  50}, {   6,  42},
	{  -4,  81}, {   1,  63}, {  -4,  70}, {   0,  67}, {   2,  57}, {  -2,  76},
	{  11,  35}, {   4,  64}, {   1,  61}, {  11,  35}, {  18,  25}, {  12,  24},
	{  13,  29}, {  13,  36}, { -10,  93}, {  -7,  73}, {  -2,  73}, {  13,  46},
	{   9,  49}, {  -7, 100}, {   9,  53}, {   2,  53}, {   5,  53}, {  -2,  61},
	{   0,  56}, {   0,  56}, { -13,  63}, {  -5,  60}, {  -1,  62}, {   4,  57},
	{  -6,  69}, {   4,  57}, {  14,  39}, {   4,  51}, {  13,  68}, {   3,  64},
	{   1,  61}, {   9,  63}, {   7,  50}, {  16,  39}, {   5,  44}, {   4,  52},
	{  11,  48}, {  -5,  60}, {  -1,  59}, {   0,  59}, {  22,  33}, {   5,  44},
	{  14,  43}, {  -1,  78}, {   0,  60}, {   9,  69}, {  11,  28}, {   2,  40},
	{   3,  44}, {   0,  49}, {   0,  46}, {   2,  44}, {   2,  51}, {   0,  47},
	{   4,  39}, {   2,  62}, {   6,  46}, {   0,  54}, {   3,  54}, {   2,  58},
	{   4,  63}, {   6,  51}, {   6,  57}, {   7,  53}, {   6,  52}, {   6,  55},
	{  11,  45}, {  14,  36}, {   8,  53}, {  -1,  82}, {   7,  55}, {  -3,  78},
	{  15,  46}, {  22,  31}, {  -1,  84}, {  25,   7}, {  30,  -7}, {  28,   3},
	{  28,   4}, {  32,   0}, {  34,  -1}, {  30,   6}, {  30,   6}, {  32,   9},
	{  31,  19}, {  26,  27}, {  26,  30}, {  37,  20}, {  28,  34}, {  17,  70},
	{   1,  67}, {   5,  59}, {   9,  67}, {  16,  30}, {  18,  32}, {  18,  35},
	{  22,  29}, {  24,  31}, {  23,  38}, {  18,  43}, {  20,  41}, {  11,  63},
	{   9,  59}, {   9,  64}, {  -1,  94}, {  -2,  89}, {  -9, 108}, {  -6,  76},
	{  -2,  44}, {   0,  45}, {   0,  52}, {  -3,  64}, {  -2,  59}, {  -4,  70},
	{  -4,  75}, {  -8,  82}, { -17, 102}, {  -9,  77}, {   3,  24}, {   0,  42},
	{   0,  48}, {   0,  55}, {  -6,  59}, {  -7,  71}, { -12,  83}, { -11,  87},
	{ -30, 119}, {   1,  58}, {  -3,  29}, {  -1,  36}, {   1,  38}, {   2,  43},
	{  -6,  55}, {   0,  58}, {   0,  64}, {  -3,  74}, { -10,  90}, {   0,  70},
	{  -4,  29}, {   5,  31}, {   7,  42}, {   1,  59}, {  -2,  58}, {  -3,  72},
	{  -3,  81}, { -11,  97}, {   0,  58}, {   8,   5}, {  10,  14}, {  14,  18},
	{  13,  27}, {   2,  40}, {   0,  58}, {  -3,  70}, {  -6,  79}, {  -8,  85},
	{   0,   0}, { -13, 106}, { -16, 106}, { -10,  87}, { -21, 114}, { -18, 110},
	{ -14,  98}, { -22, 110}, { -21, 106}, { -18, 103}, { -21, 107}, { -23, 108},
	{ -26, 112}, { -10,  96}, { -12,  95}, {  -5,  91}, {  -9,  93}, { -22,  94},
	{  -5,  86}, {   9,  67}, {  -4,  80}, { -10,  85}, {  -1,  70}, {   7,  60},
	{   9,  58}, {   5,  61}, {  12,  50}, {  15,  50}, {  18,  49}, {  17,  54},
	{  10,  41}, {   7,  46}, {  -1,  51}, {   7,  49}, {   8,  52}, {   9,  41},
	{   6,  47}, {   2,  55}, {  13,  41}, {  10,  44}, {   6,  50}, {   5,  53},
	{  13,  49}, {   4,  63}, {   6,  64}, {  -2,  69}, {  -2,  59}, {   6,  70},
	{  10,  44}, {   9,  31}, {  12,  43}, {   3,  53}, {  14,  34}, {  10,  38},
	{  -3,  52}, {  13,  40}, {  17,  32}, {   7,  44}, {   7,  38}, {  13,  50},
	{  10,  57}, {  26,  43}, {  14,  11}, {  11,  14}, {   9,  11}, {  18,  11},
	{  21,   9}, {  23,  -2}, {  32, -15}, {  32, -15}, {  34, -21}, {  39, -23},
	{  42, -33}, {  41, -31}, {  46, -28}, {  38, -12}, {  21,  29}, {  45, -24},
	{  53, -45}, {  48, -26}, {  65, -43}, {  43, -19}, {  39, -10}, {  30,   9},
	{  18,  26}, {  20,  27}, {   0,  57}, { -14,  82}, {  -5,  75}, { -19,  97},
	{ -35, 125}, {  27,   0}, {  28,   0}, {  31,  -4}, {  27,   6}, {  34,   8},
	{  30,  10}, {  24,  22}, {  33,  19}, {  22,  32}, {  26,  31}, {  21,  41},
	{  26,  44}, {  23,  47}, {  16,  65}, {  14,  71}, {   8,  60}, {   6,  63},
	{  17,  65}, {  21,  24}, {  23,  20}, {  26,  23}, {  27,  32}, {  28,  23},
	{  28,  24}, {  23,  40}, {  24,  32}, {  28,  29}, {  23,  42}, {  19,  57},
	{  22,  53}, {  22,  61}, {  11,  86}, {  12,  40}, {  11,  51}, {  14,  59},
	{  -4,  79}, {  -7,  71}, {  -5,  69}, {  -9,  70}, {  -8,  66}, { -10,  68},
	{ -19,  73}, { -12,  69}, { -16,  70}, { -15,  67}, { -20,  62}, { -19,  70},
	{ -16,  66}, { -22,  65}, { -20,  63}, {   9,  -2}, {  26,  -9}, {  33,  -9},
	{  39,  -7}, {  41,  -2}, {  45,   3}, {  49,   9}, {  45,  27}, {  36,  59},
	{  -6,  66}, {  -7,  35}, {  -7,  42}, {  -8,  45}, {  -5,  48}, { -12,  56},
	{  -6,  60}, {  -5,  62}, {  -8,  66}, {  -8,  76}, {  -5,  85}, {  -6,  81},
	{ -10,  77}, {  -7,  81}, { -17,  80}, { -18,  73}, {  -4,  74}, { -10,  83},
	{  -9,  71}, {  -9,  67}, {  -1,  61}, {  -8,  66}, { -14,  66}, {   0,  59},
	{   2,  59}, {  21, -13}, {  33, -14}, {  39,  -7}, {  46,  -2}, {  51,   2},
	{  60,   6}, {  61,  17}, {  55,  34}, {  42,  62}, {  -7,  92}, {  -5,  89},
	{  -7,  96}, { -13, 108}, {  -3,  46}, {  -1,  65}, {  -1,  57}, {  -9,  93},
	{  -3,  74}, {  -9,  92}, {  -8,  87}, { -23, 126}, {  -7,  92}, {  -5,  89},
	{  -7,  96}, { -13, 108}, {  -3,  46}, {  -1,  65}, {  -1,  57}, {  -9,  93},
	{  -3,  74}, {  -9,  92}, {  -8,  87}, { -23, 126}, {  -2,  85}, {  -6,  78},
	{  -1,  75}, {  -7,  77}, {   2,  54}, {   5,  50}, {  -3,  68}, {   1,  50},
	{   6,  42}, {  -4,  81}, {   1,  63}, {  -4,  70}, {   0,  67}, {   2,  57},
	{  -2,  76}, {  11,  35}, {   4,  64}, {   1,  61}, {  11,  35}, {  18,  25},
	{  12,  24}, {  13,  29}, {  13,  36}, { -10,  93}, {  -7,  73}, {  -2,  73},
	{  13,  46}, {   9,  49}, {  -7, 100}, {   9,  53}, {   2,  53}, {   5,  53},
	{  -2,  61}, {   0,  56}, {   0,  56}, { -13,  63}, {  -5,  60}, {  -1,  62},
	{   4,  57}, {  -6,  69}, {   4,  57}, {  14,  39}, {   4,  51}, {  13,  68},
	{  -2,  85}, {  -6,  78}, {  -1,  75}, {  -7,  77}, {   2,  54}, {   5,  50},
	{  -3,  68}, {   1,  50}, {   6,  42}, {  -4,  81}, {   1,  63}, {  -4,  70},
	{   0,  67}, {   2,  57}, {  -2,  76}, {  11,  35}, {   4,  64}, {   1,  61},
	{  11,  35}, {  18,  25}, {  12,  24}, {  13,  29}, {  13,  36}, { -10,  93},
	{  -7,  73}, {  -2,  73}, {  13,  46}, {   9,  49}, {  -7, 100}, {   9,  53},
	{   2,  53}, {   5,  53}, {  -2,  61}, {   0,  56}, {   0,  56}, { -13,  63},
	{  -5,  60}, {  -1,  62}, {   4,  57}, {  -6,  69}, {   4,  57}, {  14,  39},
	{   4,  51}, {  13,  68}, {  11,  28}, {   2,  40}, {   3,  44}, {   0,  49},
	{   0,  46}, {   2,  44}, {   2,  51}, {   0,  47}, {   4,  39}, {   2,  62},
	{   6,  46}, {   0,  54}, {   3,  54}, {   2,  58}, {   4,  63}, {   6,  51},
	{   6,  57}, {   7,  53}, {   6,  52}, {   6,  55}, {  11,  45}, {  14,  36},
	{   8,  53}, {  -1,  82}, {   7,  55}, {  -3,  78}, {  15,  46}, {  22,  31},
	{  -1,  84}, {  25,   7}, {  30,  -7}, {  28,   3}, {  28,   4}, {  32,   0},
	{  34,  -1}, {  30,   6}, {  30,   6}, {  32,   9}, {  31,  19}, {  26,  27},
	{  26,  30}, {  37,  20}, {  28,  34}, {  17,  70}, {  11,  28}, {   2,  40},
	{   3,  44}, {   0,  49}, {   0,  46}, {   2,  44}, {   2,  51}, {   0,  47},
	{   4,  39}, {   2,  62}, {   6,  46}, {   0,  54}, {   3,  54}, {   2,  58},
	{   4,  63}, {   6,  51}, {   6,  57}, {   7,  53}, {   6,  52}, {   6,  55},
	{  11,  45}, {  14,  36}, {   8,  53}, {  -1,  82}, {   7,  55}, {  -3,  78},
	{  15,  46}, {  22,  31}, {  -1,  84}, {  25,   7}, {  30,  -7}, {  28,   3},
	{  28,   4}, {  32,   0}, {  34,  -1}, {  30,   6}, {  30,   6}, {  32,   9},
	{  31,  19}, {  26,  27}, {  26,  30}, {  37,  20}, {  28,  34}, {  17,  70},
	{  -4,  79}, {  -7,  71}, {  -5,  69}, {  -9,  70}, {  -8,  66}, { -10,  68},
	{ -19,  73}, { -12,  69}, { -16,  70}, { -15,  67}, { -20,  62}, { -19,  70},
	{ -16,  66}, { -22,  65}, { -20,  63}, {  -5,  85}, {  -6,  81}, { -10,  77},
	{  -7,  81}, { -17,  80}, { -18,  73}, {  -4,  74}, { -10,  83}, {  -9,  71},
	{  -9,  67}, {  -1,  61}, {  -8,  66}, { -14,  66}, {   0,  59}, {   2,  59},
	{   9,  -2}, {  26,  -9}, {  33,  -9}, {  39,  -7}, {  41,  -2}, {  45,   3},
	{  49,   9}, {  45,  27}, {  36,  59}, {  21, -13}, {  33, -14}, {  39,  -7},
	{  46,  -2}, {  51,   2}, {  60,   6}, {  61,  17}, {  55,  34}, {  42,  62},
	{  -6,  66}, {  -7,  35}, {  -7,  42}, {  -8,  45}, {  -5,  48}, { -12,  56},
	{  -6,  60}, {  -5,  62}, {  -8,  66}, {  -8,  76}, {  -4,  79}, {  -7,  71},
	{  -5,  69}, {  -9,  70}, {  -8,  66}, { -10,  68}, { -19,  73}, { -12,  69},
	{ -16,  70}, { -15,  67}, { -20,  62}, { -19,  70}, { -16,  66}, { -22,  65},
	{ -20,  63}, {  -5,  85}, {  -6,  81}, { -10,  77}, {  -7,  81}, { -17,  80},
	{ -18,  73}, {  -4,  74}, { -10,  83}, {  -9,  71}, {  -9,  67}, {  -1,  61},
	{  -8,  66}, { -14,  66}, {   0,  59}, {   2,  59}, {   9,  -2}, {  26,  -9},
	{  33,  -9}, {  39,  -7}, {  41,  -2}, {  45,   3}, {  49,   9}, {  45,  27},
	{  36,  59}, {  21, -13}, {  33, -14}, {  39,  -7}, {  46,  -2}, {  51,   2},
	{  60,   6}, {  61,  17}, {  55,  34}, {  42,  62}, {  -6,  66}, {  -7,  35},
	{  -7,  42}, {  -8,  45}, {  -5,  48}, { -12,  56}, {  -6,  60}, {  -5,  62},
	{  -8,  66}, {  -8,  76}, { -13, 106}, { -16, 106}, { -10,  87}, { -21, 114},
	{ -18, 110}, { -14,  98}, { -22, 110}, { -21, 106}, { -18, 103}, { -21, 107},
	{ -23, 108}, { -26, 112}, { -10,  96}, { -12,  95}, {  -5,  91}, {  -9,  93},
	{ -22,  94}, {  -5,  86}, {   9,  67}, {  -4,  80}, { -10,  85}, {  -1,  70},
	{   7,  60}, {   9,  58}, {   5,  61}, {  12,  50}, {  15,  50}, {  18,  49},
	{  17,  54}, {  10,  41}, {   7,  46}, {  -1,  51}, {   7,  49}, {   8,  52},
	{   9,  41}, {   6,  47}, {   2,  55}, {  13,  41}, {  10,  44}, {   6,  50},
	{   5,  53}, {  13,  49}, {   4,  63}, {   6,  64}, { -13, 106}, { -16, 106},
	{ -10,  87}, { -21, 114}, { -18, 110}, { -14,  98}, { -22, 110}, { -21, 106},
	{ -18, 103}, { -21, 107}, { -23, 108}, { -26, 112}, { -10,  96}, { -12,  95},
	{  -5,  91}, {  -9,  93}, { -22,  94}, {  -5,  86}, {   9,  67}, {  -4,  80},
	{ -10,  85}, {  -1,  70}, {   7,  60}, {   9,  58}, {   5,  61}, {  12,  50},
	{  15,  50}, {  18,  49}, {  17,  54}, {  10,  41}, {   7,  46}, {  -1,  51},
	{   7,  49}, {   8,  52}, {   9,  41}, {   6,  47}, {   2,  55}, {  13,  41},
	{  10,  44}, {   6,  50}, {   5,  53}, {  13,  49}, {   4,  63}, {   6,  64},
	{  14,  11}, {  11,  14}, {   9,  11}, {  18,  11}, {  21,   9}, {  23,  -2},
	{  32, -15}, {  32, -15}, {  34, -21}, {  39, -23}, {  42, -33}, {  41, -31},
	{  46, -28}, {  38, -12}, {  21,  29}, {  45, -24}, {  53, -45}, {  48, -26},
	{  65, -43}, {  43, -19}, {  39, -10}, {  30,   9}, {  18,  26}, {  20,  27},
	{   0,  57}, { -14,  82}, {  -5,  75}, { -19,  97}, { -35, 125}, {  27,   0},
	{  28,   0}, {  31,  -4}, {  27,   6}, {  34,   8}, {  30,  10}, {  24,  22},
	{  33,  19}, {  22,  32}, {  26,  31}, {  21,  41}, {  26,  44}, {  23,  47},
	{  16,  65}, {  14,  71}, {  14,  11}, {  11,  14}, {   9,  11}, {  18,  11},
	{  21,   9}, {  23,  -2}, {  32, -15}, {  32, -15}, {  34, -21}, {  39, -23},
	{  42, -33}, {  41, -31}, {  46, -28}, {  38, -12}, {  21,  29}, {  45, -24},
	{  53, -45}, {  48, -26}, {  65, -43}, {  43, -19}, {  39, -10}, {  30,   9},
	{  18,  26}, {  20,  27}, {   0,  57}, { -14,  82}, {  -5,  75}, { -19,  97},
	{ -35, 125}, {  27,   0}, {  28,   0}, {  31,  -4}, {  27,   6}, {  34,   8},
	{  30,  10}, {  24,  22}, {  33,  19}, {  22,  32}, {  26,  31}, {  21,  41},
	{  26,  44}, {  23,  47}, {  16,  65}, {  14,  71}, {  -6,  76}, {  -2,  44},
	{   0,  45}, {   0,  52}, {  -3,  64}, {  -2,  59}, {  -4,  70}, {  -4,  75},
	{  -8,  82}, { -17, 102}, {  -9,  77}, {   3,  24}, {   0,  42}, {   0,  48},
	{   0,  55}, {  -6,  59}, {  -7,  71}, { -12,  83}, { -11,  87}, { -30, 119},
	{   1,  58}, {  -3,  29}, {  -1,  36}, {   1,  38}, {   2,  43}, {  -6,  55},
	{   0,  58}, {   0,  64}, {  -3,  74}, { -10,  90}, {  -6,  76}, {  -2,  44},
	{   0,  45}, {   0,  52}, {  -3,  64}, {  -2,  59}, {  -4,  70}, {  -4,  75},
	{  -8,  82}, { -17, 102}, {  -9,  77}, {   3,  24}, {   0,  42}, {   0,  48},
	{   0,  55}, {  -6,  59}, {  -7,  71}, { -12,  83}, { -11,  87}, { -30, 119},
	{   1,  58}, {  -3,  29}, {  -1,  36}, {   1,  38}, {   2,  43}, {  -6,  55},
	{   0,  58}, {   0,  64}, {  -3,  74}, { -10,  90}, {  -3,  74}, {  -9,  92},
	{  -8,  87}, { -23, 126}, {  -3,  74}, {  -9,  92}, {  -8,  87}, { -23, 126},
	{  -3,  74}, {  -9,  92}, {  -8,  87}, { -23, 126},
	}, {
	{  20, -15}, {   2,  54}, {   3,  74}, {  20, -15}, {   2,  54}, {   3,  74},
	{ -28, 127}, { -23, 104}, {  -6,  53}, {  -1,  54}, {   7,  51}, {  22,  25},
	{  34,   0}, {  16,   0}, {  -2,   9}, {   4,  41}, { -29, 118}, {   2,  65},
	{  -6,  71}, { -13,  79}, {   5,  52}, {   9,  50}, {  -3,  70}, {  10,  54},
	{  26,  34}, {  19,  22}, {  40,   0}, {  57,   2}, {  41,  36}, {  26,  69},
	{ -45, 127}, { -15, 101}, {  -4,  76}, {  -6,  71}, { -13,  79}, {   5,  52},
	{   6,  69}, { -13,  90}, {   0,  52}, {   8,  43}, {  -2,  69}, {  -5,  82},
	{ -10,  96}, {   2,  59}, {   2,  75}, {  -3,  87}, {  -3, 100}, {   1,  56},
	{  -3,  74}, {  -6,  85}, {   0,  59}, {  -3,  81}, {  -7,  86}, {  -5,  95},
	{  -1,  66}, {  -1,  77}, {   1,  70}, {  -2,  86}, {  -5,  72}, {   0,  61},
	{   0,  41}, {   0,  63}, {   0,  63}, {   0,  63}, {  -9,  83}, {   4,  86},
	{   0,  97}, {  -7,  72}, {  13,  41}, {   3,  62}, {  13,  15}, {   7,  51},
	{   2,  80}, { -39, 127}, { -18,  91}, { -17,  96}, { -26,  81}, { -35,  98},
	{ -24, 102}, { -23,  97}, { -27, 119}, { -24,  99}, { -21, 110}, { -18, 102},
	{ -36, 127}, {   0,  80}, {  -5,  89}, {  -7,  94}, {  -4,  92}, {   0,  39},
	{   0,  65}, { -15,  84}, { -35, 127}, {  -2,  73}, { -12, 104}, {  -9,  91},
	{ -31, 127}, {   3,  55}, {   7,  56}, {   7,  55}, {   8,  61}, {  -3,  53},
	{   0,  68}, {  -7,  74}, {  -9,  88}, { -13, 103}, { -13,  91}, {  -9,  89},
	{ -14,  92}, {  -8,  76}, { -12,  87}, { -23, 110}, { -24, 105}, { -10,  78},
	{ -20, 112}, { -17,  99}, { -78, 127}, { -70, 127}, { -50, 127}, { -46, 127},
	{  -4,  66}, {  -5,  78}, {  -4,  71}, {  -8,  72}, {   2,  59}, {  -1,  55},
	{  -7,  70}, {  -6,  75}, {  -8,  89}, { -34, 119}, {  -3,  75}, {  32,  20},
	{  30,  22}, { -44, 127}, {   0,  54}, {  -5,  61}, {   0,  58}, {  -1,  60},
	{  -3,  61}, {  -8,  67}, { -25,  84}, { -14,  74}, {  -5,  65}, {   5,  52},
	{   2,  57}, {   0,  61}, {  -9,  69}, { -11,  70}, {  18,  55}, {  -4,  71},
	{   0,  58}, {   7,  61}, {   9,  41}, {  18,  25}, {   9,  32}, {   5,  43},
	{   9,  47}, {   0,  44}, {   0,  51}, {   2,  46}, {  19,  38}, {  -4,  66},
	{  15,  38}, {  12,  42}, {   9,  34}, {   0,  89}, {   4,  45}, {  10,  28},
	{  10,  31}, {  33, -11}, {  52, -43}, {  18,  15}, {  28,   0}, {  35, -22},
	{  38, -25}, {  34,   0}, {  39, -18}, {  32, -12}, { 102, -94}, {   0,   0},
	{  56, -15}, {  33,  -4}, {  29,  10}, {  37,  -5}, {  51, -29}, {  39,  -9},
	{  52, -34}, {  69, -58}, {  67, -63}, {  44,  -5}, {  32,   7}, {  55, -29},
	{  32,   1}, {   0,   0}, {  27,  36}, {  33, -25}, {  34, -30}, {  36, -28},
	{  38, -28}, {  38, -27}, {  34, -18}, {  35, -16}, {  34, -14}, {  32,  -8},
	{  37,  -6}, {  35,   0}, {  30,  10}, {  28,  18}, {  26,  25}, {  29,  41},
	{   0,  75}, {   2,  72}, {   8,  77}, {  14,  35}, {  18,  31}, {  17,  35},
	{  21,  30}, {  17,  45}, {  20,  42}, {  18,  45}, {  27,  26}, {  16,  54},
	{   7,  66}, {  16,  56}, {  11,  73}, {  10,  67}, { -10, 116}, { -23, 112},
	{ -15,  71}, {  -7,  61}, {   0,  53}, {  -5,  66}, { -11,  77}, {  -9,  80},
	{  -9,  84}, { -10,  87}, { -34, 127}, { -21, 101}, {  -3,  39}, {  -5,  53},
	{  -7,  61}, { -11,  75}, { -15,  77}, { -17,  91}, { -25, 107}, { -25, 111},
	{ -28, 122}, { -11,  76}, { -10,  44}, { -10,  52}, { -10,  57}, {  -9,  58},
	{ -16,  72}, {  -7,  69}, {  -4,  69}, {  -5,  74}, {  -9,  86}, {   2,  66},
	{  -9,  34}, {   1,  32}, {  11,  31}, {   5,  52}, {  -2,  55}, {  -2,  67},
	{   0,  73}, {  -8,  89}, {   3,  52}, {   7,   4}, {  10,   8}, {  17,   8},
	{  16,  19}, {   3,  37}, {  -1,  61}, {  -5,  73}, {  -1,  70}, {  -4,  78},
	{   0,   0}, { -21, 126}, { -23, 124}, { -20, 110}, { -26, 126}, { -25, 124},
	{ -17, 105}, { -27, 121}, { -27, 117}, { -17, 102}, { -26, 117}, { -27, 116},
	{ -33, 122}, { -10,  95}, { -14, 100}, {  -8,  95}, { -17, 111}, { -28, 114},
	{  -6,  89}, {  -2,  80}, {  -4,  82}, {  -9,  85}, {  -8,  81}, {  -1,  72},
	{   5,  64}, {   1,  67}, {   9,  56}, {   0,  69}, {   1,  69}, {   7,  69},
	{  -7,  69}, {  -6,  67}, { -16,  77}, {  -2,  64}, {   2,  61}, {  -6,  67},
	{  -3,  64}, {   2,  57}, {  -3,  65}, {  -3,  66}, {   0,  62}, {   9,  51},
	{  -1,  66}, {  -2,  71}, {  -2,  75}, {  -1,  70}, {  -9,  72}, {  14,  60},
	{  16,  37}, {   0,  47}, {  18,  35}, {  11,  37}, {  12,  41}, {  10,  41},
	{   2,  48}, {  12,  41}, {  13,  41}, {   0,  59}, {   3,  50}, {  19,  40},
	{   3,  66}, {  18,  50}, {  19,  -6}, {  18,  -6}, {  14,   0}, {  26, -12},
	{  31, -16}, {  33, -25}, {  33, -22}, {  37, -28}, {  39, -30}, {  42, -30},
	{  47, -42}, {  45, -36}, {  49, -34}, {  41, -17}, {  32,   9}, {  69, -71},
	{  63, -63}, {  66, -64}, {  77, -74}, {  54, -39}, {  52, -35}, {  41, -10},
	{  36,   0}, {  40,  -1}, {  30,  14}, {  28,  26}, {  23,  37}, {  12,  55},
	{  11,  65}, {  37, -33}, {  39, -36}, {  40, -37}, {  38, -30}, {  46, -33},
	{  42, -30}, {  40, -24}, {  49, -29}, {  38, -12}, {  40, -10}, {  38,  -3},
	{  46,  -5}, {  31,  20}, {  29,  30}, {  25,  44}, {  12,  48}, {  11,  49},
	{  26,  45}, {  22,  22}, {  23,  22}, {  27,  21}, {  33,  20}, {  26,  28},
	{  30,  24}, {  27,  34}, {  18,  42}, {  25,  39}, {  18,  50}, {  12,  70},
	{  21,  54}, {  14,  71}, {  11,  83}, {  25,  32}, {  21,  49}, {  21,  54},
	{  -5,  85}, {  -6,  81}, { -10,  77}, {  -7,  81}, { -17,  80}, { -18,  73},
	{  -4,  74}, { -10,  83}, {  -9,  71}, {  -9,  67}, {  -1,  61}, {  -8,  66},
	{ -14,  66}, {   0,  59}, {   2,  59}, {  17, -10}, {  32, -13}, {  42,  -9},
	{  49,  -5}, {  53,   0}, {  64,   3}, {  68,  10}, {  66,  27}, {  47,  57},
	{  -5,  71}, {   0,  24}, {  -1,  36}, {  -2,  42}, {  -2,  52}, {  -9,  57},
	{  -6,  63}, {  -4,  65}, {  -4,  67}, {  -7,  82}, {  -3,  81}, {  -3,  76},
	{  -7,  72}, {  -6,  78}, { -12,  72}, { -14,  68}, {  -3,  70}, {  -6,  76},
	{  -5,  66}, {  -5,  62}, {   0,  57}, {  -4,  61}, {  -9,  60}, {   1,  54},
	{   2,  58}, {  17, -10}, {  32, -13}, {  42,  -9}, {  49,  -5}, {  53,   0},
	{  64,   3}, {  68,  10}, {  66,  27}, {  47,  57}, {   0,  80}, {  -5,  89},
	{  -7,  94}, {  -4,  92}, {   0,  39}, {   0,  65}, { -15,  84}, { -35, 127},
	{  -2,  73}, { -12, 104}, {  -9,  91}, { -31, 127}, {   0,  80}, {  -5,  89},
	{  -7,  94}, {  -4,  92}, {   0,  39}, {   0,  65}, { -15,  84}, { -35, 127},
	{  -2,  73}, { -12, 104}, {  -9,  91}, { -31, 127}, { -13, 103}, { -13,  91},
	{  -9,  89}, { -14,  92}, {  -8,  76}, { -12,  87}, { -23, 110}, { -24, 105},
	{ -10,  78}, { -20, 112}, { -17,  99}, { -78, 127}, { -70, 127}, { -50, 127},
	{ -46, 127}, {  -4,  66}, {  -5,  78}, {  -4,  71}, {  -8,  72}, {   2,  59},
	{  -1,  55}, {  -7,  70}, {  -6,  75}, {  -8,  89}, { -34, 119}, {  -3,  75},
	{  32,  20}, {  30,  22}, { -44, 127}, {   0,  54}, {  -5,  61}, {   0,  58},
	{  -1,  60}, {  -3,  61}, {  -8,  67}, { -25,  84}, { -14,  74}, {  -5,  65},
	{   5,  52}, {   2,  57}, {   0,  61}, {  -9,  69}, { -11,  70}, {  18,  55},
	{ -13, 103}, { -13,  91}, {  -9,  89}, { -14,  92}, {  -8,  76}, { -12,  87},
	{ -23, 110}, { -24, 105}, { -10,  78}, { -20, 112}, { -17,  99}, { -78, 127},
	{ -70, 127}, { -50, 127}, { -46, 127}, {  -4,  66}, {  -5,  78}, {  -4,  71},
	{  -8,  72}, {   2,  59}, {  -1,  55}, {  -7,  70}, {  -6,  75}, {  -8,  89},
	{ -34, 119}, {  -3,  75}, {  32,  20}, {  30,  22}, { -44, 127}, {   0,  54},
	{  -5,  61}, {   0,  58}, {  -1,  60}, {  -3,  61}, {  -8,  67}, { -25,  84},
	{ -14,  74}, {  -5,  65}, {   5,  52}, {   2,  57}, {   0,  61}, {  -9,  69},
	{ -11,  70}, {  18,  55}, {   4,  45}, {  10,  28}, {  10,  31}, {  33, -11},
	{  52, -43}, {  18,  15}, {  28,   0}, {  35, -22}, {  38, -25}, {  34,   0},
	{  39, -18}, {  32, -12}, { 102, -94}, {   0,   0}, {  56, -15}, {  33,  -4},
	{  29,  10}, {  37,  -5}, {  51, -29}, {  39,  -9}, {  52, -34}, {  69, -58},
	{  67, -63}, {  44,  -5}, {  32,   7}, {  55, -29}, {  32,   1}, {   0,   0},
	{  27,  36}, {  33, -25}, {  34, -30}, {  36, -28}, {  38, -28}, {  38, -27},
	{  34, -18}, {  35, -16}, {  34, -14}, {  32,  -8}, {  37,  -6}, {  35,   0},
	{  30,  10}, {  28,  18}, {  26,  25}, {  29,  41}, {   4,  45}, {  10,  28},
	{  10,  31}, {  33, -11}, {  52, -43}, {  18,  15}, {  28,   0}, {  35, -22},
	{  38, -25}, {  34,   0}, {  39, -18}, {  32, -12}, { 102, -94}, {   0,   0},
	{  56, -15}, {  33,  -4}, {  29,  10}, {  37,  -5}, {  51, -29}, {  39,  -9},
	{  52, -34}, {  69, -58}, {  67, -63}, {  44,  -5}, {  32,   7}, {  55, -29},
	{  32,   1}, {   0,   0}, {  27,  36}, {  33, -25}, {  34, -30}, {  36, -28},
	{  38, -28}, {  38, -27}, {  34, -18}, {  35, -16}, {  34, -14}, {  32,  -8},
	{  37,  -6}, {  35,   0}, {  30,  10}, {  28,  18}, {  26,  25}, {  29,  41},
	{  -5,  85}, {  -6,  81}, { -10,  77}, {  -7,  81}, { -17,  80}, { -18,  73},
	{  -4,  74}, { -10,  83}, {  -9,  71}, {  -9,  67}, {  -1,  61}, {  -8,  66},
	{ -14,  66}, {   0,  59}, {   2,  59}, {  -3,  81}, {  -3,  76}, {  -7,  72},
	{  -6,  78}, { -12,  72}, { -14,  68}, {  -3,  70}, {  -6,  76}, {  -5,  66},
	{  -5,  62}, {   0,  57}, {  -4,  61}, {  -9,  60}, {   1,  54}, {   2,  58},
	{  17, -10}, {  32, -13}, {  42,  -9}, {  49,  -5}, {  53,   0}, {  64,   3},
	{  68,  10}, {  66,  27}, {  47,  57}, {  17, -10}, {  32, -13}, {  42,  -9},
	{  49,  -5}, {  53,   0}, {  64,   3}, {  68,  10}, {  66,  27}, {  47,  57},
	{  -5,  71}, {   0,  24}, {  -1,  36}, {  -2,  42}, {  -2,  52}, {  -9,  57},
	{  -6,  63}, {  -4,  65}, {  -4,  67}, {  -7,  82}, {  -5,  85}, {  -6,  81},
	{ -10,  77}, {  -7,  81}, { -17,  80}, { -18,  73}, {  -4,  74}, { -10,  83},
	{  -9,  71}, {  -9,  67}, {  -1,  61}, {  -8,  66}, { -14,  66}, {   0,  59},
	{   2,  59}, {  -3,  81}, {  -3,  76}, {  -7,  72}, {  -6,  78}, { -12,  72},
	{ -14,  68}, {  -3,  70}, {  -6,  76}, {  -5,  66}, {  -5,  62}, {   0,  57},
	{  -4,  61}, {  -9,  60}, {   1,  54}, {   2,  58}, {  17, -10}, {  32, -13},
	{  42,  -9}, {  49,  -5}, {  53,   0}, {  64,   3}, {  68,  10}, {  66,  27},
	{  47,  57}, {  17, -10}, {  32, -13}, {  42,  -9}, {  49,  -5}, {  53,   0},
	{  64,   3}, {  68,  10}, {  66,  27}, {  47,  57}, {  -5,  71}, {   0,  24},
	{  -1,  36}, {  -2,  42}, {  -2,  52}, {  -9,  57}, {  -6,  63}, {  -4,  65},
	{  -4,  67}, {  -7,  82}, { -21, 126}, { -23, 124}, { -20, 110}, { -26, 126},
	{ -25, 124}, { -17, 105}, { -27, 121}, { -27, 117}, { -17, 102}, { -26, 117},
	{ -27, 116}, { -33, 122}, { -10,  95}, { -14, 100}, {  -8,  95}, { -17, 111},
	{ -28, 114}, {  -6,  89}, {  -2,  80}, {  -4,  82}, {  -9,  85}, {  -8,  81},
	{  -1,  72}, {   5,  64}, {   1,  67}, {   9,  56}, {   0,  69}, {   1,  69},
	{   7,  69}, {  -7,  69}, {  -6,  67}, { -16,  77}, {  -2,  64}, {   2,  61},
	{  -6,  67}, {  -3,  64}, {   2,  57}, {  -3,  65}, {  -3,  66}, {   0,  62},
	{   9,  51}, {  -1,  66}, {  -2,  71}, {  -2,  75}, { -21, 126}, { -23, 124},
	{ -20, 110}, { -26, 126}, { -25, 124}, { -17, 105}, { -27, 121}, { -27, 117},
	{ -17, 102}, { -26, 117}, { -27, 116}, { -33, 122}, { -10,  95}, { -14, 100},
	{  -8,  95}, { -17, 111}, { -28, 114}, {  -6,  89}, {  -2,  80}, {  -4,  82},
	{  -9,  85}, {  -8,  81}, {  -1,  72}, {   5,  64}, {   1,  67}, {   9,  56},
	{   0,  69}, {   1,  69}, {   7,  69}, {  -7,  69}, {  -6,  67}, { -16,  77},
	{  -2,  64}, {   2,  61}, {  -6,  67}, {  -3,  64}, {   2,  57}, {  -3,  65},
	{  -3,  66}, {   0,  62}, {   9,  51}, {  -1,  66}, {  -2,  71}, {  -2,  75},
	{  19,  -6}, {  18,  -6}, {  14,   0}, {  26, -12}, {  31, -16}, {  33, -25},
	{  33, -22}, {  37, -28}, {  39, -30}, {  42, -30}, {  47, -42}, {  45, -36},
	{  49, -34}, {  41, -17}, {  32,   9}, {  69, -71}, {  63, -63}, {  66, -64},
	{  77, -74}, {  54, -39}, {  52, -35}, {  41, -10}, {  36,   0}, {  40,  -1},
	{  30,  14}, {  28,  26}, {  23,  37}, {  12,  55}, {  11,  65}, {  37, -33},
	{  39, -36}, {  40, -37}, {  38, -30}, {  46, -33}, {  42, -30}, {  40, -24},
	{  49, -29}, {  38, -12}, {  40, -10}, {  38,  -3}, {  46,  -5}, {  31,  20},
	{  29,  30}, {  25,  44}, {  19,  -6}, {  18,  -6}, {  14,   0}, {  26, -12},
	{  31, -16}, {  33, -25}, {  33, -22}, {  37, -28}, {  39, -30}, {  42, -30},
	{  47, -42}, {  45, -36}, {  49, -34}, {  41, -17}, {  32,   9}, {  69, -71},
	{  63, -63}, {  66, -64}, {  77, -74}, {  54, -39}, {  52, -35}, {  41, -10},
	{  36,   0}, {  40,  -1}, {  30,  14}, {  28,  26}, {  23,  37}, {  12,  55},
	{  11,  65}, {  37, -33}, {  39, -36}, {  40, -37}, {  38, -30}, {  46, -33},
	{  42, -30}, {  40, -24}, {  49, -29}, {  38, -12}, {  40, -10}, {  38,  -3},
	{  46,  -5}, {  31,  20}, {  29,  30}, {  25,  44}, { -23, 112}, { -15,  71},
	{  -7,  61}, {   0,  53}, {  -5,  66}, { -11,  77}, {  -9,  80}, {  -9,  84},
	{ -10,  87}, { -34, 127}, { -21, 101}, {  -3,  39}, {  -5,  53}, {  -7,  61},
	{ -11,  75}, { -15,  77}, { -17,  91}, { -25, 107}, { -25, 111}, { -28, 122},
	{ -11,  76}, { -10,  44}, { -10,  52}, { -10,  57}, {  -9,  58}, { -16,  72},
	{  -7,  69}, {  -4,  69}, {  -5,  74}, {  -9,  86}, { -23, 112}, { -15,  71},
	{  -7,  61}, {   0,  53}, {  -5,  66}, { -11,  77}, {  -9,  80}, {  -9,  84},
	{ -10,  87}, { -34, 127}, { -21, 101}, {  -3,  39}, {  -5,  53}, {  -7,  61},
	{ -11,  75}, { -15,  77}, { -17,  91}, { -25, 107}, { -25, 111}, { -28, 122},
	{ -11,  76}, { -10,  44}, { -10,  52}, { -10,  57}, {  -9,  58}, { -16,  72},
	{  -7,  69}, {  -4,  69}, {  -5,  74}, {  -9,  86}, {  -2,  73}, { -12, 104},
	{  -9,  91}, { -31, 127}, {  -2,  73}, { -12, 104}, {  -9,  91}, { -31, 127},
	{  -2,  73}, { -12, 104}, {  -9,  91}, { -31, 127},
	}, {
	{  20, -15}, {   2,  54}, {   3,  74}, {  20, -15}, {   2,  54}, {   3,  74},
	{ -28, 127}, { -23, 104}, {  -6,  53}, {  -1,  54}, {   7,  51}, {  29,  16},
	{  25,   0}, {  14,   0}, { -10,  51}, {  -3,  62}, { -27,  99}, {  26,  16},
	{  -4,  85}, { -24, 102}, {   5,  57}, {   6,  57}, { -17,  73}, {  14,  57},
	{  20,  40}, {  20,  10}, {  29,   0}, {  54,   0}, {  37,  42}, {  12,  97},
	{ -32, 127}, { -22, 117}, {  -2,  74}, {  -4,  85}, { -24, 102}, {   5,  57},
	{  -6,  93}, { -14,  88}, {  -6,  44}, {   4,  55}, { -11,  89}, { -15, 103},
	{ -21, 116}, {  19,  57}, {  20,  58}, {   4,  84}, {   6,  96}, {   1,  63},
	{  -5,  85}, { -13, 106}, {   5,  63}, {   6,  75}, {  -3,  90}, {  -1, 101},
	{   3,  55}, {  -4,  79}, {  -2,  75}, { -12,  97}, {  -7,  50}, {   1,  60},
	{   0,  41}, {   0,  63}, {   0,  63}, {   0,  63}, {  -9,  83}, {   4,  86},
	{   0,  97}, {  -7,  72}, {  13,  41}, {   3,  62}, {   7,  34}, {  -9,  88},
	{ -20, 127}, { -36, 127}, { -17,  91}, { -14,  95}, { -25,  84}, { -25,  86},
	{ -12,  89}, { -17,  91}, { -31, 127}, { -14,  76}, { -18, 103}, { -13,  90},
	{ -37, 127}, {  11,  80}, {   5,  76}, {   2,  84}, {   5,  78}, {  -6,  55},
	{   4,  61}, { -14,  83}, { -37, 127}, {  -5,  79}, { -11, 104}, { -11,  91},
	{ -30, 127}, {   0,  65}, {  -2,  79}, {   0,  72}, {  -4,  92}, {  -6,  56},
	{   3,  68}, {  -8,  71}, { -13,  98}, {  -4,  86}, { -12,  88}, {  -5,  82},
	{  -3,  72}, {  -4,  67}, {  -8,  72}, { -16,  89}, {  -9,  69}, {  -1,  59},
	{   5,  66}, {   4,  57}, {  -4,  71}, {  -2,  71}, {   2,  58}, {  -1,  74},
	{  -4,  44}, {  -1,  69}, {   0,  62}, {  -7,  51}, {  -4,  47}, {  -6,  42},
	{  -3,  41}, {  -6,  53}, {   8,  76}, {  -9,  78}, { -11,  83}, {   9,  52},
	{   0,  67}, {  -5,  90}, {   1,  67}, { -15,  72}, {  -5,  75}, {  -8,  80},
	{ -21,  83}, { -21,  64}, { -13,  31}, { -25,  64}, { -29,  94}, {   9,  75},
	{  17,  63}, {  -8,  74}, {  -5,  35}, {  -2,  27}, {  13,  91}, {   3,  65},
	{  -7,  69}, {   8,  77}, { -10,  66}, {   3,  62}, {  -3,  68}, { -20,  81},
	{   0,  30}, {   1,   7}, {  -3,  23}, { -21,  74}, {  16,  66}, { -23, 124},
	{  17,  37}, {  44, -18}, {  50, -34}, { -22, 127}, {   4,  39}, {   0,  42},
	{   7,  34}, {  11,  29}, {   8,  31}, {   6,  37}, {   7,  42}, {   3,  40},
	{   8,  33}, {  13,  43}, {  13,  36}, {   4,  47}, {   3,  55}, {   2,  58},
	{   6,  60}, {   8,  44}, {  11,  44}, {  14,  42}, {   7,  48}, {   4,  56},
	{   4,  52}, {  13,  37}, {   9,  49}, {  19,  58}, {  10,  48}, {  12,  45},
	{   0,  69}, {  20,  33}, {   8,  63}, {  35, -18}, {  33, -25}, {  28,  -3},
	{  24,  10}, {  27,   0}, {  34, -14}, {  52, -44}, {  39, -24}, {  19,  17},
	{  31,  25}, {  36,  29}, {  24,  33}, {  34,  15}, {  30,  20}, {  22,  73},
	{  20,  34}, {  19,  31}, {  27,  44}, {  19,  16}, {  15,  36}, {  15,  36},
	{  21,  28}, {  25,  21}, {  30,  20}, {  31,  12}, {  27,  16}, {  24,  42},
	{   0,  93}, {  14,  56}, {  15,  57}, {  26,  38}, { -24, 127}, { -24, 115},
	{ -22,  82}, {  -9,  62}, {   0,  53}, {   0,  59}, { -14,  85}, { -13,  89},
	{ -13,  94}, { -11,  92}, { -29, 127}, { -21, 100}, { -14,  57}, { -12,  67},
	{ -11,  71}, { -10,  77}, { -21,  85}, { -16,  88}, { -23, 104}, { -15,  98},
	{ -37, 127}, { -10,  82}, {  -8,  48}, {  -8,  61}, {  -8,  66}, {  -7,  70},
	{ -14,  75}, { -10,  79}, {  -9,  83}, { -12,  92}, { -18, 108}, {  -4,  79},
	{ -22,  69}, { -16,  75}, {  -2,  58}, {   1,  58}, { -13,  78}, {  -9,  83},
	{  -4,  81}, { -13,  99}, { -13,  81}, {  -6,  38}, { -13,  62}, {  -6,  58},
	{  -2,  59}, { -16,  73}, { -10,  76}, { -13,  86}, {  -9,  83}, { -10,  87},
	{   0,   0}, { -22, 127}, { -25, 127}, { -25, 120}, { -27, 127}, { -19, 114},
	{ -23, 117}, { -25, 118}, { -26, 117}, { -24, 113}, { -28, 118}, { -31, 120},
	{ -37, 124}, { -10,  94}, { -15, 102}, { -10,  99}, { -13, 106}, { -50, 127},
	{  -5,  92}, {  17,  57}, {  -5,  86}, { -13,  94}, { -12,  91}, {  -2,  77},
	{   0,  71}, {  -1,  73}, {   4,  64}, {  -7,  81}, {   5,  64}, {  15,  57},
	{   1,  67}, {   0,  68}, { -10,  67}, {   1,  68}, {   0,  77}, {   2,  64},
	{   0,  68}, {  -5,  78}, {   7,  55}, {   5,  59}, {   2,  65}, {  14,  54},
	{  15,  44}, {   5,  60}, {   2,  70}, {  -2,  76}, { -18,  86}, {  12,  70},
	{   5,  64}, { -12,  70}, {  11,  55}, {   5,  56}, {   0,  69}, {   2,  65},
	{  -6,  74}, {   5,  54}, {   7,  54}, {  -6,  76}, { -11,  82}, {  -2,  77},
	{  -2,  77}, {  25,  42}, {  17, -13}, {  16,  -9}, {  17, -12}, {  27, -21},
	{  37, -30}, {  41, -40}, {  42, -41}, {  48, -47}, {  39, -32}, {  46, -40},
	{  52, -51}, {  46, -41}, {  52, -39}, {  43, -19}, {  32,  11}, {  61, -55},
	{  56, -46}, {  62, -50}, {  81, -67}, {  45, -20}, {  35,  -2}, {  28,  15},
	{  34,   1}, {  39,   1}, {  30,  17}, {  20,  38}, {  18,  45}, {  15,  54},
	{   0,  79}, {  36, -16}, {  37, -14}, {  37, -17}, {  32,   1}, {  34,  15},
	{  29,  15}, {  24,  25}, {  34,  22}, {  31,  16}, {  35,  18}, {  31,  28},
	{  33,  41}, {  36,  28}, {  27,  47}, {  21,  62}, {  18,  31}, {  19,  26},
	{  36,  24}, {  24,  23}, {  27,  16}, {  24,  30}, {  31,  29}, {  22,  41},
	{  22,  42}, {  16,  60}, {  15,  52}, {  14,  60}, {   3,  78}, { -16, 123},
	{  21,  53}, {  22,  56}, {  25,  61}, {  21,  33}, {  19,  50}, {  17,  61},
	{  -3,  78}, {  -8,  74}, {  -9,  72}, { -10,  72}, { -18,  75}, { -12,  71},
	{ -11,  63}, {  -5,  70}, { -17,  75}, { -14,  72}, { -16,  67}, {  -8,  53},
	{ -14,  59}, {  -9,  52}, { -11,  68}, {   9,  -2}, {  30, -10}, {  31,  -4},
	{  33,  -1}, {  33,   7}, {  31,  12}, {  37,  23}, {  31,  38}, {  20,  64},
	{  -9,  71}, {  -7,  37}, {  -8,  44}, { -11,  49}, { -10,  56}, { -12,  59},
	{  -8,  63}, {  -9,  67}, {  -6,  68}, { -10,  79}, {  -3,  78}, {  -8,  74},
	{  -9,  72}, { -10,  72}, { -18,  75}, { -12,  71}, { -11,  63}, {  -5,  70},
	{ -17,  75}, { -14,  72}, { -16,  67}, {  -8,  53}, { -14,  59}, {  -9,  52},
	{ -11,  68}, {   9,  -2}, {  30, -10}, {  31,  -4}, {  33,  -1}, {  33,   7},
	{  31,  12}, {  37,  23}, {  31,  38}, {  20,  64}, {  11,  80}, {   5,  76},
	{   2,  84}, {   5,  78}, {  -6,  55}, {   4,  61}, { -14,  83}, { -37, 127},
	{  -5,  79}, { -11, 104}, { -11,  91}, { -30, 127}, {  11,  80}, {   5,  76},
	{   2,  84}, {   5,  78}, {  -6,  55}, {   4,  61}, { -14,  83}, { -37, 127},
	{  -5,  79}, { -11, 104}, { -11,  91}, { -30, 127}, {  -4,  86}, { -12,  88},
	{  -5,  82}, {  -3,  72}, {  -4,  67}, {  -8,  72}, { -16,  89}, {  -9,  69},
	{  -1,  59}, {   5,  66}, {   4,  57}, {  -4,  71}, {  -2,  71}, {   2,  58},
	{  -1,  74}, {  -4,  44}, {  -1,  69}, {   0,  62}, {  -7,  51}, {  -4,  47},
	{  -6,  42}, {  -3,  41}, {  -6,  53}, {   8,  76}, {  -9,  78}, { -11,  83},
	{   9,  52}, {   0,  67}, {  -5,  90}, {   1,  67}, { -15,  72}, {  -5,  75},
	{  -8,  80}, { -21,  83}, { -21,  64}, { -13,  31}, { -25,  64}, { -29,  94},
	{   9,  75}, {  17,  63}, {  -8,  74}, {  -5,  35}, {  -2,  27}, {  13,  91},
	{  -4,  86}, { -12,  88}, {  -5,  82}, {  -3,  72}, {  -4,  67}, {  -8,  72},
	{ -16,  89}, {  -9,  69}, {  -1,  59}, {   5,  66}, {   4,  57}, {  -4,  71},
	{  -2,  71}, {   2,  58}, {  -1,  74}, {  -4,  44}, {  -1,  69}, {   0,  62},
	{  -7,  51}, {  -4,  47}, {  -6,  42}, {  -3,  41}, {  -6,  53}, {   8,  76},
	{  -9,  78}, { -11,  83}, {   9,  52}, {   0,  67}, {  -5,  90}, {   1,  67},
	{ -15,  72}, {  -5,  75}, {  -8,  80}, { -21,  83}, { -21,  64}, { -13,  31},
	{ -25,  64}, { -29,  94}, {   9,  75}, {  17,  63}, {  -8,  74}, {  -5,  35},
	{  -2,  27}, {  13,  91}, {   4,  39}, {   0,  42}, {   7,  34}, {  11,  29},
	{   8,  31}, {   6,  37}, {   7,  42}, {   3,  40}, {   8,  33}, {  13,  43},
	{  13,  36}, {   4,  47}, {   3,  55}, {   2,  58}, {   6,  60}, {   8,  44},
	{  11,  44}, {  14,  42}, {   7,  48}, {   4,  56}, {   4,  52}, {  13,  37},
	{   9,  49}, {  19,  58}, {  10,  48}, {  12,  45}, {   0,  69}, {  20,  33},
	{   8,  63}, {  35, -18}, {  33, -25}, {  28,  -3}, {  24,  10}, {  27,   0},
	{  34, -14}, {  52, -44}, {  39, -24}, {  19,  17}, {  31,  25}, {  36,  29},
	{  24,  33}, {  34,  15}, {  30,  20}, {  22,  73}, {   4,  39}, {   0,  42},
	{   7,  34}, {  11,  29}, {   8,  31}, {   6,  37}, {   7,  42}, {   3,  40},
	{   8,  33}, {  13,  43}, {  13,  36}, {   4,  47}, {   3,  55}, {   2,  58},
	{   6,  60}, {   8,  44}, {  11,  44}, {  14,  42}, {   7,  48}, {   4,  56},
	{   4,  52}, {  13,  37}, {   9,  49}, {  19,  58}, {  10,  48}, {  12,  45},
	{   0,  69}, {  20,  33}, {   8,  63}, {  35, -18}, {  33, -25}, {  28,  -3},
	{  24,  10}, {  27,   0}, {  34, -14}, {  52, -44}, {  39, -24}, {  19,  17},
	{  31,  25}, {  36,  29}, {  24,  33}, {  34,  15}, {  30,  20}, {  22,  73},
	{  -3,  78}, {  -8,  74}, {  -9,  72}, { -10,  72}, { -18,  75}, { -12,  71},
	{ -11,  63}, {  -5,  70}, { -17,  75}, { -14,  72}, { -16,  67}, {  -8,  53},
	{ -14,  59}, {  -9,  52}, { -11,  68}, {  -3,  78}, {  -8,  74}, {  -9,  72},
	{ -10,  72}, { -18,  75}, { -12,  71}, { -11,  63}, {  -5,  70}, { -17,  75},
	{ -14,  72}, { -16,  67}, {  -8,  53}, { -14,  59}, {  -9,  52}, { -11,  68},
	{   9,  -2}, {  30, -10}, {  31,  -4}, {  33,  -1}, {  33,   7}, {  31,  12},
	{  37,  23}, {  31,  38}, {  20,  64}, {   9,  -2}, {  30, -10}, {  31,  -4},
	{  33,  -1}, {  33,   7}, {  31,  12}, {  37,  23}, {  31,  38}, {  20,  64},
	{  -9,  71}, {  -7,  37}, {  -8,  44}, { -11,  49}, { -10,  56}, { -12,  59},
	{  -8,  63}, {  -9,  67}, {  -6,  68}, { -10,  79}, {  -3,  78}, {  -8,  74},
	{  -9,  72}, { -10,  72}, { -18,  75}, { -12,  71}, { -11,  63}, {  -5,  70},
	{ -17,  75}, { -14,  72}, { -16,  67}, {  -8,  53}, { -14,  59}, {  -9,  52},
	{ -11,  68}, {  -3,  78}, {  -8,  74}, {  -9,  72}, { -10,  72}, { -18,  75},
	{ -12,  71}, { -11,  63}, {  -5,  70}, { -17,  75}, { -14,  72}, { -16,  67},
	{  -8,  53}, { -14,  59}, {  -9,  52}, { -11,  68}, {   9,  -2}, {  30, -10},
	{  31,  -4}, {  33,  -1}, {  33,   7}, {  31,  12}, {  37,  23}, {  31,  38},
	{  20,  64}, {   9,  -2}, {  30, -10}, {  31,  -4}, {  33,  -1}, {  33,   7},
	{  31,  12}, {  37,  23}, {  31,  38}, {  20,  64}, {  -9,  71}, {  -7,  37},
	{  -8,  44}, { -11,  49}, { -10,  56}, { -12,  59}, {  -8,  63}, {  -9,  67},
	{  -6,  68}, { -10,  79}, { -22, 127}, { -25, 127}, { -25, 120}, { -27, 127},
	{ -19, 114}, { -23, 117}, { -25, 118}, { -26, 117}, { -24, 113}, { -28, 118},
	{ -31, 120}, { -37, 124}, { -10,  94}, { -15, 102}, { -10,  99}, { -13, 106},
	{ -50, 127}, {  -5,  92}, {  17,  57}, {  -5,  86}, { -13,  94}, { -12,  91},
	{  -2,  77}, {   0,  71}, {  -1,  73}, {   4,  64}, {  -7,  81}, {   5,  64},
	{  15,  57}, {   1,  67}, {   0,  68}, { -10,  67}, {   1,  68}, {   0,  77},
	{   2,  64}, {   0,  68}, {  -5,  78}, {   7,  55}, {   5,  59}, {   2,  65},
	{  14,  54}, {  15,  44}, {   5,  60}, {   2,  70}, { -22, 127}, { -25, 127},
	{ -25, 120}, { -27, 127}, { -19, 114}, { -23, 117}, { -25, 118}, { -26, 117},
	{ -24, 113}, { -28, 118}, { -31, 120}, { -37, 124}, { -10,  94}, { -15, 102},
	{ -10,  99}, { -13, 106}, { -50, 127}, {  -5,  92}, {  17,  57}, {  -5,  86},
	{ -13,  94}, { -12,  91}, {  -2,  77}, {   0,  71}, {  -1,  73}, {   4,  64},
	{  -7,  81}, {   5,  64}, {  15,  57}, {   1,  67}, {   0,  68}, { -10,  67},
	{   1,  68}, {   0,  77}, {   2,  64}, {   0,  68}, {  -5,  78}, {   7,  55},
	{   5,  59}, {   2,  65}, {  14,  54}, {  15,  44}, {   5,  60}, {   2,  70},
	{  17, -13}, {  16,  -9}, {  17, -12}, {  27, -21}, {  37, -30}, {  41, -40},
	{  42, -41}, {  48, -47}, {  39, -32}, {  46, -40}, {  52, -51}, {  46, -41},
	{  52, -39}, {  43, -19}, {  32,  11}, {  61, -55}, {  56, -46}, {  62, -50},
	{  81, -67}, {  45, -20}, {  35,  -2}, {  28,  15}, {  34,   1}, {  39,   1},
	{  30,  17}, {  20,  38}, {  18,  45}, {  15,  54}, {   0,  79}, {  36, -16},
	{  37, -14}, {  37, -17}, {  32,   1}, {  34,  15}, {  29,  15}, {  24,  25},
	{  34,  22}, {  31,  16}, {  35,  18}, {  31,  28}, {  33,  41}, {  36,  28},
	{  27,  47}, {  21,  62}, {  17, -13}, {  16,  -9}, {  17, -12}, {  27, -21},
	{  37, -30}, {  41, -40}, {  42, -41}, {  48, -47}, {  39, -32}, {  46, -40},
	{  52, -51}, {  46, -41}, {  52, -39}, {  43, -19}, {  32,  11}, {  61, -55},
	{  56, -46}, {  62, -50}, {  81, -67}, {  45, -20}, {  35,  -2}, {  28,  15},
	{  34,   1}, {  39,   1}, {  30,  17}, {  20,  38}, {  18,  45}, {  15,  54},
	{   0,  79}, {  36, -16}, {  37, -14}, {  37, -17}, {  32,   1}, {  34,  15},
	{  29,  15}, {  24,  25}, {  34,  22}, {  31,  16}, {  35,  18}, {  31,  28},
	{  33,  41}, {  36,  28}, {  27,  47}, {  21,  62}, { -24, 115}, { -22,  82},
	{  -9,  62}, {   0,  53}, {   0,  59}, { -14,  85}, { -13,  89}, { -13,  94},
	{ -11,  92}, { -29, 127}, { -21, 100}, { -14,  57}, { -12,  67}, { -11,  71},
	{ -10,  77}, { -21,  85}, { -16,  88}, { -23, 104}, { -15,  98}, { -37, 127},
	{ -10,  82}, {  -8,  48}, {  -8,  61}, {  -8,  66}, {  -7,  70}, { -14,  75},
	{ -10,  79}, {  -9,  83}, { -12,  92}, { -18, 108}, { -24, 115}, { -22,  82},
	{  -9,  62}, {   0,  53}, {   0,  59}, { -14,  85}, { -13,  89}, { -13,  94},
	{ -11,  92}, { -29, 127}, { -21, 100}, { -14,  57}, { -12,  67}, { -11,  71},
	{ -10,  77}, { -21,  85}, { -16,  88}, { -23, 104}, { -15,  98}, { -37, 127},
	{ -10,  82}, {  -8,  48}, {  -8,  61}, {  -8,  66}, {  -7,  70}, { -14,  75},
	{ -10,  79}, {  -9,  83}, { -12,  92}, { -18, 108}, {  -5,  79}, { -11, 104},
	{ -11,  91}, { -30, 127}, {  -5,  79}, { -11, 104}, { -11,  91}, { -30, 127},
	{  -5,  79}, { -11, 104}, { -11,  91}, { -30, 127},
}};



static const v16qu sig_inc_4x4 = {0, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0};
static const v16qu sig_inc_8x8[2][4] = {{
	{ 0, 12, 10, 14, 11, 13, 12, 11,  9, 10, 14,  9,  6, 11, 13, 12},
	{11,  6,  8,  9, 10, 14,  9,  8,  7,  6, 11, 13, 12, 11,  6,  7},
	{ 7,  8,  9, 10,  9,  8,  7,  7,  7,  6,  3,  3,  4,  4,  4,  4},
	{ 5,  5,  4,  4,  4,  3,  3,  4,  4,  5,  5,  4,  3,  2,  1,  0},
	}, {
	{ 0, 14, 14, 14, 14, 14, 10, 10,  9,  9, 13, 13,  8, 10, 10,  9},
	{ 9, 13, 13,  8, 10, 10,  9,  9, 11, 12, 11,  8, 10, 10,  9,  9},
	{11, 12, 11,  8, 10, 10,  9,  9, 11, 12, 11,  8, 10, 10,  9,  6},
	{ 5,  4,  8,  7,  7,  7,  6,  5,  4,  3,  3,  2,  2,  1,  1,  0},
}};
static const v16qu last_inc_8x8[4] = {
	{0, 8, 8, 8, 7, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5},
	{4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3},
	{2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2},
	{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
};
static const union { uint8_t q[8]; uint64_t l; } sig_inc_chromaDC[2] =
	{{{0, 2, 1, 0}}, {{0, 2, 2, 2, 1, 1, 0, 0}}};

static const v16qu scan_4x4[2] = {
	{15, 11, 14, 13, 10, 7, 3, 6, 9, 12, 8, 5, 2, 1, 4, 0},
	{15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 3, 2, 4, 1, 0},
};
static const v16qu scan_8x8[2][4] = {{
	{63, 55, 62, 61, 54, 47, 39, 46, 53, 60, 59, 52, 45, 38, 31, 23},
	{30, 37, 44, 51, 58, 57, 50, 43, 36, 29, 22, 15,  7, 14, 21, 28},
	{35, 42, 49, 56, 48, 41, 34, 27, 20, 13,  6,  5, 12, 19, 26, 33},
	{40, 32, 25, 18, 11,  4,  3, 10, 17, 24, 16,  9,  2,  1,  8,  0},
	}, {
	{63, 62, 61, 60, 59, 58, 55, 54, 53, 52, 57, 56, 51, 47, 46, 45},
	{44, 50, 49, 43, 39, 38, 37, 36, 42, 48, 41, 35, 31, 30, 29, 28},
	{34, 40, 33, 27, 23, 22, 21, 20, 26, 32, 25, 19, 15, 14, 13, 18},
	{24, 17, 12,  7,  6,  5, 11, 16, 10,  4,  3,  9,  8,  2,  1,  0},
}};
static const union { uint8_t q[8]; uint64_t l; } scan_chromaDC[2][2] = {
	{{{3, 2, 1, 0}}, {{ 7,  5,  3,  6,  4, 1,  2, 0}}},
	{{{7, 6, 5, 4}}, {{15, 13, 11, 14, 12, 9, 10, 8}}},
};



/**
 * Set the initial values for CABAC states using vector code (9.3.1.1).
 *
 * Considering the bottleneck of memory access, this is probably just as fast
 * as copying from precomputed values. Please refrain from providing a default,
 * unoptimised version.
 */
#ifdef __SSSE3__
static void init_context_variables() {
	__m128i mul = _mm_set1_epi16(max(ctx->ps.QP_Y, 0) + 4096);
	const __m128i *src = (__m128i *)context_init[ctx->cabac_init_idc];
	for (__m128i *dst = (__m128i*)ctx->states; dst < (__m128i*)ctx->states + 64; dst++, src += 2) {
		__m128i sum0 = _mm_srai_epi16(_mm_maddubs_epi16(mul, src[0]), 4);
		__m128i sum1 = _mm_srai_epi16(_mm_maddubs_epi16(mul, src[1]), 4);
		__m128i min = _mm_min_epu8(_mm_packus_epi16(sum0, sum1), _mm_set1_epi8(126));
		__m128i mask = _mm_cmpgt_epi8(_mm_set1_epi8(64), min);
		__m128i preCtxState = _mm_max_epu8(min, _mm_set1_epi8(1));
		__m128i pStateIdx = _mm_xor_si128(preCtxState, mask);
		__m128i shift = _mm_add_epi8(pStateIdx, pStateIdx);
		*dst = _mm_add_epi8(_mm_add_epi8(shift, shift), _mm_add_epi8(mask, _mm_set1_epi8(1)));
	}
	((uint8_t*)ctx->states)[276] = 252;
}
#endif



/**
 * This function parses a group of significant_flags, then the corresponding
 * sequence of coeff_abs_level_minus1/coeff_sign_flag pairs (9.3.2.3).
 *
 * Bypass bits can be extracted all at once using a binary division (!!).
 * coeff_abs_level expects at most 2^(7+14), i.e 43 bits as Exp-Golomb, so we
 * use two 32bit divisions (second one being executed for long codes only).
 */
static __attribute__((noinline)) int parse_residual_block(unsigned coded_block_flag, int endIdx)
{
	if (coded_block_flag) {
		ctx->coded_block_flags[0] |= coded_block_flag;
		
		// Storage of significant_coeff_flags is reversed compared to the spec.
		uint64_t significant_coeff_flags = 0;
		do {
			if (get_ae(ctx->ctxIdxOffsets[1] + ctx->sig_inc[endIdx])) {
				significant_coeff_flags |= 1ULL << endIdx;
				if (get_ae(ctx->ctxIdxOffsets[2] + ctx->last_inc[endIdx]))
					break;
			}
		} while (--endIdx > 0);
		significant_coeff_flags |= 1ULL << endIdx;
	
		// Now loop on set bits to parse all non-zero coefficients.
		int ctxIdx0 = ctx->ctxIdxOffsets[3] + 1;
		int ctxIdx1 = ctx->ctxIdxOffsets[3] + 5;
		do {
			int coeff_level = 1;
			int ctxIdx = ctxIdx0;
			while (coeff_level < 15 && get_ae(ctxIdx))
				coeff_level++, ctxIdx = ctxIdx1;
		
			// Unsigned division uses one extra bit, so the first renorm is correct.
			if (coeff_level >= 15) {
				renorm(0, 0); // Hardcore!!!
				codIRange >>= SIZE_BIT - 9;
				uint32_t num = codIOffset >> (SIZE_BIT - 32);
				uint32_t quo = num / (uint32_t)codIRange;
				uint32_t rem = num % (uint32_t)codIRange;
			
				// 32bit/9bit division yields 23 bypass bits.
				int k = clz32(~(quo << 9));
				unsigned shift = 9 + k;
				if (__builtin_expect(k >= 12, 0)) { // At k==11, code length is 23 bits.
					codIRange <<= SIZE_BIT - 32;
					codIOffset = (SIZE_BIT == 32) ? rem : (uint32_t)codIOffset | (size_t)rem << 32;
					renorm(2, 0); // Next division will yield 21 bypass bits...
					codIRange >>= SIZE_BIT - 11;
					num = codIOffset >> (SIZE_BIT - 32);
					quo = num / (uint32_t)codIRange + (quo << 21); // ... such that we keep 11 as msb.
					rem = num % (uint32_t)codIRange;
					shift -= 21;
				}
			
				// Return the unconsumed bypass bits to codIOffset, and compute coeff_level.
				size_t mul = ((uint32_t)-1 >> 1 >> (shift + k) & quo) * (uint32_t)codIRange + rem;
				codIRange <<= SIZE_BIT - 1 - (shift + k);
				codIOffset = (SIZE_BIT == 32) ? mul : (uint32_t)codIOffset | mul << 32;
				coeff_level = 14 + (1 << k) + (quo << shift >> (31 - k));
			}
			
			// not the brightest part of spec (9.3.3.1.3), yet I did my best
			static const int8_t trans[5] = {0, 2, 3, 4, 4};
			int last_sig_offset = ctx->ctxIdxOffsets[3];
			int ctxIdxInc = trans[ctxIdx0 - last_sig_offset];
			ctxIdx0 = last_sig_offset + (coeff_level > 1 ? 0 : ctxIdxInc);
			ctxIdx1 = min(ctxIdx1 + (coeff_level > 1), (last_sig_offset == 257 ? last_sig_offset + 8 : last_sig_offset + 9));
		
			// Parse coeff_sign_flag.
			codIRange >>= 1;
			coeff_level = (codIOffset >= codIRange) ? -coeff_level : coeff_level;
			codIOffset = (codIOffset >= codIRange) ? codIOffset - codIRange : codIOffset;
			int i = ctz64(significant_coeff_flags);
			ctx->residual_block[ctx->scan[i]] = coeff_level;
		
			// Though not very efficient, this gets optimised out easily :)
			fprintf(stderr, (ctx->ctxIdxOffsets[0] == 93) ? "Luma4x4: %d\n" :
				(ctx->ctxIdxOffsets[0] == 468) ? "Cb4x4: %d\n" :
				(ctx->ctxIdxOffsets[0] == 480) ? "Cr4x4: %d\n" :
				(ctx->ctxIdxOffsets[0] == 1012) ? "Luma8x8: %d\n" :
				(ctx->ctxIdxOffsets[0] == 1016) ? "Cb8x8: %d\n" :
				(ctx->ctxIdxOffsets[0] == 1020) ? "Cr8x8: %d\n" :
				(ctx->ctxIdxOffsets[0] == 85) ? "Luma16x16: %d\n" :
				(ctx->ctxIdxOffsets[0] == 460) ? "Cb16x16: %d\n" :
				(ctx->ctxIdxOffsets[0] == 472) ? "Cr16x16: %d\n" :
				(ctx->ctxIdxOffsets[0] == 89) ? "Luma4x4: %d\n" :
				(ctx->ctxIdxOffsets[0] == 464) ? "Cb4x4: %d\n" :
				(ctx->ctxIdxOffsets[0] == 476) ? "Cr4x4: %d\n" :
				(ctx->ctxIdxOffsets[0] == 97) ? "ChromaDC: %d\n" :
				"ChromaAC: %d\n", ctx->residual_block[ctx->scan[i]]);
		} while ((significant_coeff_flags &= significant_coeff_flags - 1) != 0);
	}
	return 0;
}



/**
 * This function parses one mvd_lX symbol, using the same binary division trick
 * as above to read all bypass bits at once.
 */
static __attribute__((noinline)) int parse_mvd(int pos, int ctxBase) {
	int sum = ((uint8_t *)ctx->absMvdComp)[pos - 4] + ((uint8_t *)ctx->absMvdComp)[pos + 32];
	int ctxIdx = ctxBase + ((sum - 3) >> (WORD_BIT - 1)) + ((sum - 33) >> (WORD_BIT - 1));
	int mvd = 0;
	while (mvd < 9 && get_ae(ctxIdx))
		ctxIdx = ctxBase + min(++mvd, 4);
	
	// Once again, we use unsigned division to read all bypass bits.
	if (mvd >= 9) {
		renorm(0, 0);
		codIRange >>= SIZE_BIT - 9;
		uint32_t num = codIOffset >> (SIZE_BIT - 32);
		uint32_t quo = num / (uint32_t)codIRange;
		uint32_t rem = num % (uint32_t)codIRange;
		
		// 32bit/9bit division yields 23 bypass bits.
		int k = 3 + clz32(~(quo << 9));
		unsigned shift = 6 + k;
		if (__builtin_expect(k >= 13, 0)) { // At k==12, code length is 22 bits.
			codIRange <<= (SIZE_BIT - 32);
			codIOffset = (SIZE_BIT == 32) ? rem : (uint32_t)codIOffset | (size_t)rem << 32;
			renorm(4, 0); // Next division will yield 19 bypass bits...
			codIRange >>= SIZE_BIT - 13;
			num = codIOffset >> (SIZE_BIT - 32);
			quo = num / (uint32_t)codIRange + (quo << 19); // ... such that we keep 13 as msb.
			rem = num % (uint32_t)codIRange;
			shift -= 19;
		}
		
		// Return the unconsumed bypass bits to codIOffset, and compute mvd.
		size_t mul = ((uint32_t)-1 >> 1 >> (shift + k) & quo) * (uint32_t)codIRange + rem;
		codIRange <<= SIZE_BIT - 1 - (shift + k);
		codIOffset = (SIZE_BIT == 32) ? mul : (uint32_t)codIOffset | mul << 32;
		mvd = 1 + (1 << k) + (quo << shift >> (31 - k));
	}
	((uint8_t *)ctx->absMvdComp)[pos] = min(mvd, 66);
	
	// Parse the sign flag.
	if (mvd > 0) {
		codIRange >>= 1;
		mvd = (codIOffset >= codIRange) ? -mvd : mvd;
		codIOffset = (codIOffset >= codIRange) ? codIOffset - codIRange : codIOffset;
	}
	fprintf(stderr, "mvd_l%x: %d\n", pos >> 1 & 1, mvd);
	return mvd;
}



/**
 * As its name says, parses mb_qp_delta (9.3.2.7 and 9.3.3.1.1.5).
 *
 * bits should contain the values in coded_block_pattern as stored in ctx->f.s,
 * such that Intra16x16 can request unconditional parsing by passing -1.
 */
static __attribute__((noinline)) void parse_mb_qp_delta(unsigned bits) {
	int ctxIdxInc = ctx->mb_qp_delta_non_zero;
	ctx->mb_qp_delta_non_zero = 0;
	if (bits & (Edge264_flags){.CodedBlockPatternChromaDC = 1, .CodedBlockPatternLuma = 0x35}.s) {
		int mb_qp_delta = 0;
		if (get_ae(60 + ctxIdxInc)) {
			ctx->mb_qp_delta_non_zero |= 1;
			
			// cannot loop forever since binVal will oscillate past end of RBSP
			int count = 1, ctxIdx = 62;
			while (get_ae(ctxIdx))
				count++, ctxIdx = 63;
			mb_qp_delta = map_se(count);
			int QP = ctx->ps.QP_Y + mb_qp_delta;
			int QpBdOffset_Y = (ctx->ps.BitDepth[0] - 8) * 6;
			ctx->ps.QP_Y = (QP < -QpBdOffset_Y) ? QP + 52 + QpBdOffset_Y :
				(QP >= 52) ? QP - (52 + QpBdOffset_Y) : QP;
		}
		fprintf(stderr, "mb_qp_delta: %d\n", mb_qp_delta);
	}
}



/**
 * Parses CodedBlockPatternLuma/Chroma (9.3.2.6 and 9.3.3.1.1.4).
 *
 * As with mb_qp_delta, coded_block_pattern is parsed in two distinct code
 * paths, thus put in a non-inlined function.
 */
static __attribute__((noinline)) void parse_coded_block_pattern() {
	// Luma prefix
	unsigned CodedBlockPatternLuma = ctx->f.s;
	CodedBlockPatternLuma |= get_ae(76 - (CodedBlockPatternLuma >> left_8x8[0] & 3)) << bit_8x8[0];
	CodedBlockPatternLuma |= get_ae(76 - (CodedBlockPatternLuma >> left_8x8[1] & 3)) << bit_8x8[1];
	CodedBlockPatternLuma |= get_ae(76 - (CodedBlockPatternLuma >> left_8x8[2] & 3)) << bit_8x8[2];
	CodedBlockPatternLuma |= get_ae(76 - (CodedBlockPatternLuma >> left_8x8[3] & 3)) << bit_8x8[3];
	ctx->f.s = CodedBlockPatternLuma;
	
	// Chroma suffix
	if (ctx->ps.ChromaArrayType == 1 || ctx->ps.ChromaArrayType == 2) {
		ctx->f.CodedBlockPatternChromaDC |= get_ae(77 + ctx->ctxIdxInc.CodedBlockPatternChromaDC);
		if (ctx->f.CodedBlockPatternChromaDC)
			ctx->f.CodedBlockPatternChromaAC |= get_ae(81 + ctx->ctxIdxInc.CodedBlockPatternChromaAC);
	}
	
	fprintf(stderr, "coded_block_pattern: %u\n",
		(ctx->f.s >> bit_8x8[0] & 1) * 1 + (ctx->f.s >> bit_8x8[1] & 1) * 2 +
		(ctx->f.s >> bit_8x8[2] & 1) * 4 + (ctx->f.s >> bit_8x8[3] & 1) * 8 +
		(ctx->f.CodedBlockPatternChromaDC + ctx->f.CodedBlockPatternChromaAC) * 16);
}



/**
 * Parses intra_chroma_pred_mode (9.3.2.2 and 9.3.3.1.1.8).
 *
 * As with mb_qp_delta and coded_block_pattern, experience shows allowing
 * compilers to inline this function makes them produce slower/heavier code.
 */
static __attribute__((noinline)) void parse_intra_chroma_pred_mode() {
	if (ctx->ps.ChromaArrayType == 1 || ctx->ps.ChromaArrayType == 2) {
		int ctxIdx = 64 + ctx->ctxIdxInc.intra_chroma_pred_mode_non_zero;
		int intra_chroma_pred_mode = 0;
		while (intra_chroma_pred_mode < 3 && get_ae(ctxIdx))
			intra_chroma_pred_mode++, ctxIdx = 67;
		ctx->f.intra_chroma_pred_mode_non_zero |= (intra_chroma_pred_mode > 0);
		ctx->intra_chroma_pred_mode = intra_chroma_pred_mode;
		fprintf(stderr, "intra_chroma_pred_mode: %u\n", intra_chroma_pred_mode);
	}
}



static __attribute__((noinline)) int parse_chroma_residual() {
	static const v4hi ctxIdxOffsets_chromaDC[2] =
		{{97, 149, 210, 257}, {97, 321, 382, 257}}; // ctxBlockCat==3
	static const v4hi ctxIdxOffsets_chromaAC[2] =
		{{101, 151, 212, 266}, {101, 323, 384, 266}}; // ctxBlockCat==4
	
	int is422 = ctx->ps.ChromaArrayType - 1;
	if (is422 == 0 || is422 == 1) {
		for (int i = 0; i < 8; i++)
			ctx->residual_block_v[i] = (v4si){};
		ctx->ctxIdxOffsets_l = ctxIdxOffsets_chromaDC[ctx->f.mb_field_decoding_flag];
		ctx->sig_inc_l = ctx->last_inc_l = sig_inc_chromaDC[is422].l;
		ctx->f_v = __builtin_shufflevector(ctx->f_v, ctx->f_v, 0, 2, 1, 3);
		
		// One 2x2 or 2x4 DC block for the Cb component
		ctx->scan_l = scan_chromaDC[0][is422].l;
		unsigned coded_block_flag_Cb = 0;
		if (ctx->f.CodedBlockPatternChromaDC)
			coded_block_flag_Cb = get_ae(ctx->ctxIdxOffsets[0] + (ctx->ctxIdxInc.coded_block_flags_16x16 >> 2 & 3));
		ctx->f.coded_block_flags_16x16 |= coded_block_flag_Cb << 2;
		parse_residual_block(coded_block_flag_Cb << 1, is422 * 4 + 3);
		
		// Another 2x2/2x4 DC block for the Cr component
		ctx->scan_l = scan_chromaDC[1][is422].l;
		unsigned coded_block_flag_Cr = 0;
		if (ctx->f.CodedBlockPatternChromaDC)
			coded_block_flag_Cr = get_ae(ctx->ctxIdxOffsets[0] + (ctx->ctxIdxInc.coded_block_flags_16x16 >> 4 & 3));
		ctx->f.coded_block_flags_16x16 |= coded_block_flag_Cr << 4;
		parse_residual_block(coded_block_flag_Cr << 1, is422 * 4 + 3);
		
		// Eight or sixteen 4x4 AC blocks for the Cb/Cr components
		ctx->sig_inc_v[0] = ctx->last_inc_v[0] = sig_inc_4x4;
		ctx->scan_v[0] = scan_4x4[ctx->f.mb_field_decoding_flag];
		ctx->ctxIdxOffsets_l = ctxIdxOffsets_chromaAC[ctx->f.mb_field_decoding_flag];
		for (int luma4x4BlkIdx = 0, lim = 12 + is422 * 4; luma4x4BlkIdx < lim; luma4x4BlkIdx++) {
			if ((luma4x4BlkIdx & lim) == 4)
				luma4x4BlkIdx = 8;
			int DC = ctx->residual_block[16 + luma4x4BlkIdx];
			ctx->residual_block_v[3] = ctx->residual_block_v[2] = ctx->residual_block_v[1] = ctx->residual_block_v[0] = (v4si){};
			ctx->residual_block[0] = DC;
			uint8_t shift = left_chroma[luma4x4BlkIdx];
			unsigned coded_block_flag = 0;
			if (ctx->f.CodedBlockPatternChromaAC)
				coded_block_flag = get_ae(ctx->ctxIdxOffsets[0] + (ctx->coded_block_flags[0] >> shift & 3)) << shift >> 2;
			parse_residual_block(coded_block_flag, 14);
		}
		ctx->f_v = __builtin_shufflevector(ctx->f_v, ctx->f_v, 0, 2, 1, 3);
	}
	return 0;
}



static __attribute__((noinline)) int parse_Intra16x16_residual() {
	static const v4hi ctxIdxOffsets_16x16DC[3][2] = {
		{{85, 105, 166, 227}, {85, 277, 338, 227}}, // ctxBlockCat==0
		{{460, 484, 572, 952}, {460, 776, 864, 952}}, // ctxBlockCat==6
		{{472, 528, 616, 982}, {472, 820, 908, 982}}, // ctxBlockCat==10
	};
	static const v4hi ctxIdxOffsets_16x16AC[3][2] = {
		{{89, 119, 180, 237}, {89, 291, 352, 237}}, // ctxBlockCat==1
		{{464, 498, 586, 962}, {464, 790, 878, 962}}, // ctxBlockCat==7
		{{476, 542, 630, 992}, {476, 834, 922, 992}}, // ctxBlockCat==11
	};
	
	// Thanks to the reverse order in significant_coeff_flags, we can reuse 4x4 data.
	parse_mb_qp_delta(-1);
	int iYCbCr = ctx->colour_plane_id;
	ctx->sig_inc_v[0] = ctx->last_inc_v[0] = sig_inc_4x4;
	ctx->scan_v[0] = scan_4x4[ctx->f.mb_field_decoding_flag];
	do {
		// One 4x4 DC block
		ctx->ctxIdxOffsets_l = ctxIdxOffsets_16x16DC[iYCbCr][ctx->f.mb_field_decoding_flag];
		ctx->residual_block_v[7] = ctx->residual_block_v[6] = ctx->residual_block_v[5] = ctx->residual_block_v[4] = (v4si){};
		unsigned coded_block_flag_DC = get_ae(ctx->ctxIdxOffsets[0] + (ctx->ctxIdxInc.coded_block_flags_16x16 >> (iYCbCr * 2) & 3));
		ctx->f.coded_block_flags_16x16 |= coded_block_flag_DC << (iYCbCr * 2);
		parse_residual_block(coded_block_flag_DC << 25, 15);
		
		// Sixteen 4x4 AC blocks
		ctx->ctxIdxOffsets_l = ctxIdxOffsets_16x16AC[iYCbCr][ctx->f.mb_field_decoding_flag];
		for (int luma4x4BlkIdx = 0; luma4x4BlkIdx < 16; luma4x4BlkIdx++) {
			int DC = ctx->residual_block[16 + luma4x4BlkIdx];
			ctx->residual_block_v[3] = ctx->residual_block_v[2] = ctx->residual_block_v[1] = ctx->residual_block_v[0] = (v4si){};
			ctx->residual_block[0] = DC;
			unsigned coded_block_flag = 0;
			if (ctx->f.s & 1 << bit_8x8[luma4x4BlkIdx >> 2])
				coded_block_flag = get_ae(ctx->ctxIdxOffsets[0] + (ctx->coded_block_flags[0] >> left_4x4[luma4x4BlkIdx] & 3)) << bit_4x4[luma4x4BlkIdx];
			parse_residual_block(coded_block_flag, 14);
		}
		
		if (ctx->ps.ChromaArrayType != 3)
			return parse_chroma_residual();
		ctx->f_v = __builtin_shufflevector(ctx->f_v, ctx->f_v, 0, 2, 3, 1);
	} while (++iYCbCr < 3);
	return 0;
}



static __attribute__((noinline)) int parse_NxN_residual() {
	static const v4hi ctxIdxOffsets_4x4[3][2] = {
		{{93, 134, 195, 247}, {93, 306, 367, 247}}, // ctxBlockCat==2
		{{468, 528, 616, 972}, {468, 805, 893, 972}}, // ctxBlockCat==8
		{{480, 557, 645, 1002}, {480, 849, 937, 1002}}, // ctxBlockCat==12
	};
	static const v4hi ctxIdxOffsets_8x8[3][2] = {
		{{1012, 402, 417, 426}, {1012, 436, 451, 426}}, // ctxBlockCat==5
		{{1016, 660, 690, 708}, {1016, 675, 699, 708}}, // ctxBlockCat==9
		{{1020, 718, 748, 766}, {1020, 733, 757, 766}}, // ctxBlockCat==13
	};
	static const uint32_t cbf_8x8[4] = {0x04018408, 0x20300110, 0x100c0044, 0x01003081};
	
	parse_mb_qp_delta(ctx->f.s);
	int iYCbCr = ctx->colour_plane_id;
	do {
		// Sixteen 4x4 residual blocks?
		if (!ctx->f.transform_size_8x8_flag) {
			ctx->ctxIdxOffsets_l = ctxIdxOffsets_4x4[iYCbCr][ctx->f.mb_field_decoding_flag];
			ctx->scan_v[0] = scan_4x4[ctx->f.mb_field_decoding_flag];
			ctx->sig_inc_v[0] = ctx->last_inc_v[0] = sig_inc_4x4;
			for (int luma4x4BlkIdx = 0; luma4x4BlkIdx < 16; luma4x4BlkIdx++) {
				ctx->residual_block_v[3] = ctx->residual_block_v[2] = ctx->residual_block_v[1] = ctx->residual_block_v[0] = (v4si){};
				unsigned coded_block_flag = 0;
				if (ctx->f.s & 1 << bit_8x8[luma4x4BlkIdx >> 2])
					coded_block_flag = get_ae(ctx->ctxIdxOffsets[0] + (ctx->coded_block_flags[0] >> left_4x4[luma4x4BlkIdx] & 3)) << bit_4x4[luma4x4BlkIdx];
				parse_residual_block(coded_block_flag, 15);
			}
		
		// Or four 8x8 residual blocks :)
		} else {
			ctx->ctxIdxOffsets_l = ctxIdxOffsets_8x8[iYCbCr][ctx->f.mb_field_decoding_flag];
			const v16qu *p = sig_inc_8x8[ctx->f.mb_field_decoding_flag];
			const v16qu *r = scan_8x8[ctx->f.mb_field_decoding_flag];
			for (int i = 0; i < 4; i++) {
				v16qu a = p[i], b = last_inc_8x8[i], c = r[i];
				ctx->sig_inc_v[i] = a;
				ctx->last_inc_v[i] = b;
				ctx->scan_v[i] = c;
			}
			for (int luma8x8BlkIdx = 0; luma8x8BlkIdx < 4; luma8x8BlkIdx++) {
				for (int i = 0; i < 16; i++)
					ctx->residual_block_v[i] = (v4si){};
				unsigned coded_block_flag = 0;
				if (ctx->f.s & 1 << bit_8x8[luma8x8BlkIdx]) {
					coded_block_flag = cbf_8x8[luma8x8BlkIdx];
					if (ctx->ps.ChromaArrayType == 3)
						coded_block_flag *= get_ae(ctx->ctxIdxOffsets[0] + (ctx->coded_block_flags[0] >> left_8x8[luma8x8BlkIdx] & 3));
				}
				parse_residual_block(coded_block_flag, 63);
			}
		}
		
		if (ctx->ps.ChromaArrayType != 3)
			return parse_chroma_residual();
		ctx->f_v = __builtin_shufflevector(ctx->f_v, ctx->f_v, 0, 2, 3, 1);
	} while (++iYCbCr < 3);
	return 0;
}



/**
 * This function parses the syntax elements ref_idx_lX, mvd_lX (with function),
 * coded_block_pattern (from function), transform_size_8x8_flag, and branches to
 * residual decoding through tail call.
 */
static __attribute__((noinline)) int parse_inter_pred() {
	static const v16qi shufC_4xN[4] = {
		{8, 10, 0, 2, 9, 11, 1, 3, 10, 12, 2, 2, 11, 13, 3, 3},
		{6,  8, 0, 2, 7,  9, 1, 3,  8, 12, 2, 2,  9, 13, 3, 3},
		{8, 10, 0, 2, 9, 11, 1, 3, 10, 10, 2, 2, 11, 11, 3, 3},
		{6,  8, 0, 2, 7,  9, 1, 3,  8, 10, 2, 2,  9, 11, 3, 3},
	};
	static const v16qi shufC_8xN[4] = {
		{10, 12, 2, 0, 11, 13, 3, 1, -1, -1, -1, -1, -1, -1, -1, -1},
		{ 6, 12, 2, 0,  7, 13, 3, 1, -1, -1, -1, -1, -1, -1, -1, -1},
		{10,  8, 2, 0, 11,  9, 3, 1, -1, -1, -1, -1, -1, -1, -1, -1},
		{ 6,  8, 2, 0,  7,  9, 3, 1, -1, -1, -1, -1, -1, -1, -1, -1},
	};
	static const v16qi mvC01_4xN[8] = {
		{19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 15, 19, 19, 19, 15},
		{15, -1, 19, 19, 15, -1, 19, 19, -1, 19, 19, 15, -1, 19, 19, 15},
		{19, 19, 19, 19, 19, 19, 19, 19, 19, 15, 19, 15, 19, 15, 19, 15},
		{15, -1, 19, 19, 15, -1, 19, 19, -1, -1, 19, 15, -1, -1, 19, 15},
		{19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 15, 19, 19, 19, 15},
		{-1, -1, 19, 19, -1, -1, 19, 19, -1, 19, 19, 15, -1, 19, 19, 15},
		{19, 19, 19, 19, 19, 19, 19, 19, 19, 15, 19, 15, 19, 15, 19, 15},
		{-1, -1, 19, 19, -1, -1, 19, 19, -1, -1, 19, 15, -1, -1, 19, 15},
	};
	static const v16qi mvC01_8xN[8] = {
		{21, 21, 21, 15, 21, 21, 21, 15, 0, 0, 0, 0, 0, 0, 0, 0},
		{15, 21, 21, 15, 15, 21, 21, 15, 0, 0, 0, 0, 0, 0, 0, 0},
		{21, 15, 21, 15, 21, 15, 21, 15, 0, 0, 0, 0, 0, 0, 0, 0},
		{15, -1, 21, 15, 15, -1, 21, 15, 0, 0, 0, 0, 0, 0, 0, 0},
		{21, 21, 21, 15, 21, 21, 21, 15, 0, 0, 0, 0, 0, 0, 0, 0},
		{-1, 21, 21, 15, -1, 21, 21, 15, 0, 0, 0, 0, 0, 0, 0, 0},
		{21, 15, 21, 15, 21, 15, 21, 15, 0, 0, 0, 0, 0, 0, 0, 0},
		{-1, -1, 21, 15, -1, -1, 21, 15, 0, 0, 0, 0, 0, 0, 0, 0},
	};
	
	// Parsing for ref_idx_lX in P/B slices.
	for (unsigned f = ctx->mvd_flags & ctx->ref_idx_mask; f != 0; f &= f - 1) {
		int8_t *pos = &ctx->refIdx->q + ref_pos[__builtin_ctz(f) / 4];
		int ctxIdxInc = (pos[-2] > 0) + (pos[8] > 0) * 2;
		int refIdx = 0;
		
		// This cannot loop forever since binVal would oscillate past the end of the RBSP.
		while (get_ae(54 + ctxIdxInc))
			refIdx++, ctxIdxInc = ctxIdxInc / 4 + 4; // cool trick from ffmpeg
		*pos = refIdx;
		fprintf(stderr, "ref_idx_l%x: %u\n", __builtin_ctz(f) / 16, refIdx);
	}
	
	// Initialise all relative mvC positions using vector code (8.4.1.3).
	if (ctx->mvd_fold == 0x0011) { // 8x16 special case
		ctx->mvC[0] = ctx->mvC[16] = -1; // odd values invoke direct prediction over median.
		ctx->mvC[8] = ctx->mvC[24] = (ctx->ctxIdxInc.s >> 24 & 1) ? 15 : 21;
	} else if (ctx->mvd_fold == 0x0101) { // 16x8 special case
		ctx->mvC[0] = ctx->mvC[16] = 17;
		ctx->mvC[8] = ctx->mvC[24] = -1;
	} else {
		// Compute refIdxA/B/C for subMbPart==0 (lower vector) and 1 (upper vector).
		// 2 and 3 need only refIdxA which is the same anyway.
		unsigned mask4xN = ctx->mvd_fold & 0x2222;
		v16qi left, top;
		memcpy(&left, ctx->refIdx - 1, 16); // unaligned accesses
		memcpy(&top, ctx->refIdx + 2, 16);
		v16qi is8xN = (v16qi)(v4su){mask4xN, mask4xN, mask4xN, mask4xN} == (v16qi){};
		v16qi refIdxC_4xN = byte_shuffle(top, shufC_4xN[ctx->ctxIdxInc.s >> 23 & 3]);
		v16qi refIdxC_8xN = byte_shuffle(top, shufC_8xN[ctx->ctxIdxInc.s >> 23 & 3]);
		v16qi refIdx = __builtin_shufflevector(left, left, 12, 14, 4, 6, 13, 15, 5, 7, 12, 14, 4, 6, 13, 15, 5, 7);
		v16qi refIdxA = __builtin_shufflevector(left, left, 10, 12, 2, 4, 11, 13, 3, 5, 12, 14, 4, 6, 13, 15, 5, 7);
		v16qi refIdxB = __builtin_shufflevector(top, top, 8, 10, 0, 2, 9, 11, 1, 3, 8, 10, 0, 2, 9, 11, 1, 3);
		v16qi refIdxC = vector_select(refIdxC_4xN, refIdxC_8xN, is8xN);
	
		// With the same index order, compute relative mvC positions (see 8.4.1.3.1-1 and 8.4.1.3.2-3).
		// The lowest bit enables direct prediction instead of median (8.4.1.3.1-2).
		v16qi eqA = (refIdx == refIdxA);
		v16qi eqB = (refIdx == refIdxB);
		v16qi eqC = (refIdx == refIdxC);
		v16qi mvA = {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1};
		v16qi mvB = {17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17};
		v16qi mvC01 = vector_select(mvC01_4xN[ctx->ctxIdxInc.s >> 23], mvC01_8xN[ctx->ctxIdxInc.s >> 23], is8xN);
		v16qi direct = (eqA + eqB + eqC == mvA); // mvA==-1
		mvC01 = vector_select(vector_select(mvB | eqA, mvC01, eqC), mvC01 + mvA, direct);
		v16qi mvC23_4xN = {18, 18, 18, 18, 18, 18, 18, 18, 14, 14, 14, 14, 14, 14, 14, 14};
		v16qi mvC23_8xN = {14, 14, 14, 14, 14, 14, 14, 14, 0, 0, 0, 0, 0, 0, 0, 0};
		v16qi mvC23 = vector_select(mvC23_4xN, vector_select(mvB, mvC23_8xN, eqA), is8xN);
	
		// Shuffle these positions to actual mv parsing order and store them.
		ctx->mvC_v[0] = __builtin_shufflevector(mvC01, mvC23, 0, 8, 16, 24, 1, 9, 17, 25, 2, 10, 18, 26, 3, 11, 19, 27);
		ctx->mvC_v[1] = __builtin_shufflevector(mvC01, mvC23, 4, 12, 20, 28, 5, 13, 21, 29, 6, 14, 22, 30, 7, 15, 23, 31);
	}
	
	// Parse mvd components by pairs, to minimise branches.
	do {
		int i = ctz32(ctx->mvd_flags), pos = mv_pos[i], posC = ctx->mvC[i] << 1 & -4;
		int16_t *mvs = (int16_t*)ctx->mvs + pos;
		int mvp_x = mvs[posC], mvp_y = mvs[posC + 1];
		if (!(ctx->mvC[i] & 1))
			mvp_x = median(mvs[-4], mvs[32], mvp_x), mvp_y = median(mvs[-3], mvs[33], mvp_y);
		union { int16_t h[2]; uint32_t s; } *mv = (void *)mvs; // protects the next type-punning
		mv->h[0] = mvp_x + parse_mvd(pos, 42);
		mv->h[1] = mvp_y + parse_mvd(pos + 1, 49);
	
		// Intermediate copies for 8x8, 4x8 and 8x4 blocks.
		uint16_t *absMvdComp = (uint16_t *)((uint8_t *)ctx->absMvdComp + pos);
		uintptr_t u = (uintptr_t)ctx->mvs + (pos & 95) * 2, v = (uintptr_t)ctx->absMvdComp + (pos & 95);
		*(uint32_t *)u = *(uint32_t *)(u | 8) = *(uint32_t *)((uintptr_t)mv | 8) = mv->s;
		*(uint16_t *)v = *(uint16_t *)(v | 4) = *(uint16_t *)((uintptr_t)absMvdComp | 4) = *absMvdComp;
	} while (ctx->mvd_flags &= ctx->mvd_flags - 1);
	
	parse_coded_block_pattern();
	
	// Final copies for 16x16, 8x16 and 16x8 blocks.
	if (!(ctx->mvd_fold & 0xfff00)) { // 8x16
		ctx->refIdx[0].s = ctx->refIdx[2].s;
		ctx->mvs[0] = ctx->mvs[4] = ctx->mvs[8];
		ctx->mvs[1] = ctx->mvs[5] = ctx->mvs[9];
		ctx->absMvdComp[0] = ctx->absMvdComp[2] = ctx->absMvdComp[4];
	}
	if (!(ctx->mvd_fold & 0xff0f0)) { // 16x8
		ctx->refIdx[0].h[1] = ctx->refIdx[0].h[0];
		ctx->refIdx[2].h[1] = ctx->refIdx[2].h[0];
		ctx->mvs[1] = ctx->mvs[5] = ctx->mvs[0];
		ctx->mvs[9] = ctx->mvs[13] = ctx->mvs[8];
		ctx->absMvdComp[0] = ctx->absMvdComp[2] = (v16qu)__builtin_shufflevector((v2lu)ctx->absMvdComp[0], (v2lu){}, 0, 0);
		ctx->absMvdComp[4] = ctx->absMvdComp[6] = (v16qu)__builtin_shufflevector((v2lu)ctx->absMvdComp[4], (v2lu){}, 0, 0);
	}
	
	if (!(ctx->mvd_fold & 0xeeeee) && (ctx->f.CodedBlockPatternLuma & 0x35) && ctx->ps.transform_8x8_mode_flag) {
		ctx->f.transform_size_8x8_flag |= get_ae(399 + ctx->ctxIdxInc.transform_size_8x8_flag);
		fprintf(stderr, "transform_size_8x8_flag: %x\n", ctx->f.transform_size_8x8_flag);
	}
	return parse_NxN_residual();
}



/**
 * This function parses the syntax elements mb_type, transform_size_8x8_flag,
 * intraNxN_pred stuff, intra_chroma_pred_mode (from function), PCM stuff, and
 * coded_block_pattern (from function) for the current Intra macroblock.
 * It proceeds to residual decoding through tail call.
 */
static __attribute__((noinline)) int parse_intra_mb(int ctxIdx) {
	//v8hi *mvCol = (v8hi *)ctx->p.mvs; // p.mvs is always v8hi so this type-punning is safe
	//mvCol[0] = mvCol[1] = mvCol[2] = mvCol[3] = (v8hi){};
	if (ctx->ctxIdxInc.unavailable & 1)
		ctx->ctxIdxInc.coded_block_flags_16x16 |= 0x15, ctx->f_v |= ctx->cbf_maskA;
	if (ctx->ctxIdxInc.unavailable & 2)
		ctx->ctxIdxInc.coded_block_flags_16x16 |= 0x2a, ctx->f_v |= ctx->cbf_maskB;
	
	// I_NxN
	if (!get_ae(ctxIdx)) {
		fprintf(stderr, (ctxIdx == 17) ? "mb_type: 5\n" : (ctxIdx == 32) ? "mb_type: 23\n" : "mb_type: 0\n");
		if (ctx->ps.transform_8x8_mode_flag) {
			ctx->f.transform_size_8x8_flag |= get_ae(399 + ctx->ctxIdxInc.transform_size_8x8_flag);
			fprintf(stderr, "transform_size_8x8_flag: %x\n", ctx->f.transform_size_8x8_flag);
		}
		ctx->f.mb_type_I_NxN |= 1;
		
		// Overall code is much lighter with 4x4/8x8 sharing the parsing of IntraPredMode.
		for (int luma4x4BlkIdx = 0; luma4x4BlkIdx < 16; ) {
			int8_t *pos = &ctx->Intra4x4PredMode->q + intra_pos[luma4x4BlkIdx++];
			int IntraPredMode = abs(min(pos[-1], pos[1]));
			if (!get_ae(68)) {
				int rem_intra_pred_mode = get_ae(69);
				rem_intra_pred_mode += get_ae(69) * 2;
				rem_intra_pred_mode += get_ae(69) * 4;
				fprintf(stderr, "intra_pred_mode: %u\n", rem_intra_pred_mode);
				IntraPredMode = rem_intra_pred_mode + (rem_intra_pred_mode >= IntraPredMode);
			} else {
				fprintf(stderr, "intra_pred_mode: -1\n");
			}
			pos[0] = IntraPredMode;
			if (ctx->f.transform_size_8x8_flag)
				pos[-1] = pos[1] = IntraPredMode, luma4x4BlkIdx += 3;
		}
		
		parse_intra_chroma_pred_mode();
		parse_coded_block_pattern();
		return parse_NxN_residual();
	
	// Intra_16x16
	} else if (!get_ae(276)) {
		ctx->f.CodedBlockPatternLuma |= -get_ae(max(ctxIdx + 1, 6));
		ctx->f.CodedBlockPatternChromaDC |= get_ae(max(ctxIdx + 2, 7));
		if (ctx->f.CodedBlockPatternChromaDC) // FIXME ?
			ctx->f.CodedBlockPatternChromaAC |= get_ae(max(ctxIdx + 2, 8));
		int Intra16x16PredMode = get_ae(max(ctxIdx + 3, 9)) << 1;
		Intra16x16PredMode += get_ae(max(ctxIdx + 3, 10));
		fprintf(stderr, "mb_type: %u\n", 12 * (ctx->f.CodedBlockPatternLuma & 1) +
			4 * (ctx->f.CodedBlockPatternChromaDC + ctx->f.CodedBlockPatternChromaAC) +
			Intra16x16PredMode + (ctxIdx == 17 ? 6 : ctxIdx == 32 ? 24 : 1));
		
		parse_intra_chroma_pred_mode();
		return parse_Intra16x16_residual();
		
	// I_PCM
	} else {
		static const Edge264_flags flags_PCM = {
			.CodedBlockPatternChromaDC = 1,
			.CodedBlockPatternChromaAC = 1,
			.coded_block_flags_16x16 = 0x15,
			.CodedBlockPatternLuma = 0xff,
		};
		fprintf(stderr, "mb_type: 25\n");
		ctx->f_v = (v4su){flags_PCM.s, -1, -1, -1};
		ctx->mb_qp_delta_non_zero = 0;
		refill((ctx->shift - (SIZE_BIT - 9 - clz(codIRange)) + 7) & -8, 0);
		for (int i = 0; i < 256; i++)
			get_uv(ctx->ps.BitDepth[0]);
		for (int i = 0; i < (1 << ctx->ps.ChromaArrayType >> 1) * 128; i++)
			get_uv(ctx->ps.BitDepth[1]);
		return 0;
	}
}



/**
 * This function parses the syntax elements mb_type and sub_mb_type for the
 * current macroblock in a P/B slice, then branches to further decoding
 * (parse_intra_mb/parse_inter_pred/parse_inter_residual) through tail calls.
 */
static __attribute__((noinline)) int parse_inter_mb()
{
	static const uint16_t P2flags[4] = {0x0001, 0, 0x0011, 0x0101};
	static const uint32_t B2flags[26] = {0x00010001, 0x00000101, 0x00000011, 0x01010000,
		0x00110000, 0x01000001, 0x00100001, 0x00010100, 0x00000001, 0x00010000,
		0, 0, 0, 0, 0x00010010, 0, 0x01000101, 0x00100011, 0x01010100, 0x00110010,
		0x00010101, 0x00010011, 0x01010001, 0x00110001, 0x01010101, 0x00110011};
	static const uint32_t b2flags[13] = {0x10001, 0x00005, 0x00003, 0x50000, 0x00001,
		0x10000, 0xf0000, 0xf000f, 0x30000, 0x50005, 0x30003, 0x0000f, 0};
	static const uint8_t B2mb_type[26] = {3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 0, 0,
		0, 0, 11, 22, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21};
	static const uint8_t b2sub_mb_type[13] = {3, 4, 5, 6, 1, 2, 11, 12, 7, 8, 9, 10, 0};
	
	// Initialise with Direct motion prediction, then parse mb_type.
	if (ctx->slice_type == 0) {
		if (ctx->f.mb_skip_flag) {
			//init_P_Skip();
			return parse_NxN_residual();
		} else if (get_ae(14)) {
			v8hi *v = ctx->mvs;
			v[0] = v[1] = v[4] = v[5] = v[8] = v[9] = v[12] = v[13] = (v8hi){};
			return parse_intra_mb(17);
		}
		
		// Are these few lines worth a function? :)
		int str = get_ae(15);
		str += str + get_ae(16 + str);
		fprintf(stderr, "mb_type: %u\n", (4 - str) % 4);
		unsigned flags = P2flags[str];
		
		// Parsing for sub_mb_type in P slices.
		for (int i = 0; str == 1 && i < 16; i += 4) {
			unsigned f = get_ae(21) ? 1 : !get_ae(22) ? 5 : get_ae(23) ? 3 : 15;
			fprintf(stderr, "sub_mb_type: %c\n", (f == 1) ? '0' : (f == 5) ? '1' : (f == 3) ? '2' : '3');
			flags |= f << i;
		}
		ctx->mvd_flags = ctx->mvd_fold = flags;
	} else {
		//init_B_Direct();
		if (ctx->f.mb_skip_flag) {
			ctx->f.mb_type_B_Direct |= 1;
			return parse_NxN_residual();
			
		// B_Direct_16x16
		} else if (!get_ae(29 - ctx->ctxIdxInc.mb_type_B_Direct)) {
			fprintf(stderr, "mb_type: 0\n");
			parse_coded_block_pattern();
			if ((ctx->f.CodedBlockPatternLuma & 0x35) && ctx->ps.transform_8x8_mode_flag && ctx->ps.direct_8x8_inference_flag) {
				ctx->f.transform_size_8x8_flag |= get_ae(399 + ctx->ctxIdxInc.transform_size_8x8_flag);
				fprintf(stderr, "transform_size_8x8_flag: %x\n", ctx->f.transform_size_8x8_flag);
			}
			ctx->f.mb_type_B_Direct |= 1;
			return parse_NxN_residual();
		}
		
		// Most important here is the minimal number of conditional branches.
		int str = 4;
		if (!get_ae(30) || (str = get_ae(31),
			str += str + get_ae(32),
			str += str + get_ae(32),
			str += str + get_ae(32), str - 8 < 5u))
		{
			str += str + get_ae(32);
		}
		if (str == 13) {
			v8hi *v = ctx->mvs;
			v[0] = v[1] = v[4] = v[5] = v[8] = v[9] = v[12] = v[13] = (v8hi){};
			return parse_intra_mb(32);
		}
		fprintf(stderr, "mb_type: %u\n", B2mb_type[str]);
		ctx->mvd_fold = 0;
		unsigned flags = B2flags[str];
		
		// Parsing for sub_mb_type in B slices.
		for (int i = 0; str == 15 && i < 16; i += 4) {
			int sub = 12;
			if (!get_ae(36)) {
				ctx->mvd_fold = (ctx->ps.direct_8x8_inference_flag) ? 0x10000 : 0x20000;
			} else {
				sub = 2;
				if (!get_ae(37) || (sub = get_ae(38),
					sub += sub + get_ae(39),
					sub += sub + get_ae(39), sub - 4 < 2u))
				{
					sub += sub + get_ae(39);
				}
				flags |= b2flags[sub] << i;
			}
			fprintf(stderr, "sub_mb_type: %u\n", b2sub_mb_type[sub]);
		}
		ctx->mvd_flags = flags;
		ctx->mvd_fold |= (uint16_t)flags | flags >> 16;
	}
	return parse_inter_pred();
}



/**
 * This function allocates all VLAs on its stack, then loops through the
 * macroblocks of a slice, setting their neighbouring data and calling
 * parse_inter/intra_mb for each one.
 */
__attribute__((noinline)) void CABAC_parse_slice_data()
{
	static const Edge264_flags unavail_mb = {
		.mb_skip_flag = 1,
		.mb_type_I_NxN = 1,
		.mb_type_B_Direct = 1,
		.unavailable = 1,
		.CodedBlockPatternLuma = 0xff,
	};
	static const Edge264_flags twice = {
		.CodedBlockPatternChromaDC = 1,
		.CodedBlockPatternChromaAC = 1,
		.coded_block_flags_16x16 = 0x15,
		.unavailable = 1,
	};
	
	// Initialise the CABAC engine.
	ctx->range = codIRange;
	ctx->offset = codIOffset;
	codIRange = (size_t)255 << (SIZE_BIT - 9);
	codIOffset = get_uv(SIZE_BIT - 1);
	init_context_variables();
	
	// Mbaff shares all of the above functions except the code below.
	if (!ctx->MbaffFrameFlag) {
		ctx->ctxIdxInc.unavailable |= 2;
		ctx->cbf_maskA = (v4si){0, 0x42404202, 0x42404202, 0x42404202};
		ctx->cbf_maskB = (v4si){0, 0x88820820, 0x88820820, 0x88820820};
		if (ctx->ps.ChromaArrayType != 3)
			ctx->cbf_maskA[2] = 0x24902490, ctx->cbf_maskB[2] = 0x50005000;
		int PicHeightInMbs = ctx->ps.height / 16 >> ctx->field_pic_flag;
		int PicWidthInMbs = ctx->ps.width / 16;
		int mb_y = PicHeightInMbs - 1 - ctx->y / 16;
		int mb_x = ctx->x / 16;
		
		// Create the circular buffers and position their pointers.
		v4su flags[PicWidthInMbs + 2];
		for (int u = 0; u < PicWidthInMbs + 2; u++)
			flags[u] = (v4su){unavail_mb.s, 0, 0, 0};
		ctx->flags = &flags[mb_x + 1];
		uint32_t Intra4x4PredMode[mb_y * 4 + PicWidthInMbs + 5];
		memset(Intra4x4PredMode, -2, sizeof(Intra4x4PredMode));
		ctx->Intra4x4PredMode = (void*)&Intra4x4PredMode[mb_y * 4 + mb_x + 1];
		uint32_t refIdx[mb_y * 4 + PicWidthInMbs + 6];
		memset(refIdx, -1, sizeof(refIdx));
		ctx->refIdx = (void*)&refIdx[mb_y * 4 + mb_x + 1];
		v8hi mvs[mb_y * 16 + PicWidthInMbs * 2 + 18];
		memset(mvs, 0, sizeof(mvs));
		ctx->mvs = &mvs[mb_y * 16 + mb_x * 2 + 1];
		v16qu absMvdComp[mb_y * 8 + PicWidthInMbs + 9];
		memset(absMvdComp, 0, sizeof(absMvdComp));
		ctx->absMvdComp = &absMvdComp[mb_y * 8 + mb_x + 1];
		
		do {
			fprintf(stderr, "\n********** %u **********\n", ctx->ps.width * ctx->y / 256 + ctx->x / 16);
			ctx->f_v = (ctx->flags[-1] << (v4su){1, 1, 1, 1} & (v4su){0x42000000, 0x42404202, 0x42404202, 0x42404202}) |
				(ctx->flags[0] << (v4su){3, 3, 3, 3} & (v4su){0x88000000, 0x88000000, 0x88000000, 0x88000000}) |
				(ctx->flags[0] << (v4su){5, 5, 5, 5} & (v4su){0, 0x820820, 0x820820, 0x820820});
			if (ctx->ps.ChromaArrayType != 3) {
				ctx->coded_block_flags[1] = (ctx->flags[-1][2] << 4 & 0x24902490) |
					(ctx->flags[0][2] << (ctx->ps.ChromaArrayType * 6) & 0x50005000);
			}
			ctx->ctxIdxInc.s = ((ctx->flags[-1][0] + ctx->flags[0][0] + (ctx->flags[0][0] & twice.s)) & 0xffffff) |
				((ctx->flags[1][0] & 0x400000) | (ctx->ctxIdxInc.s & 0x800000)) << 2;
			
			// P/B slices have some more initialisation.
			if (ctx->slice_type > 1) {
				parse_intra_mb(5 - ctx->ctxIdxInc.mb_type_I_NxN);
			} else {
				ctx->refIdx[0].s = ctx->refIdx[2].s = -1;
				v16qu *v = ctx->absMvdComp;
				v[0] = v[2] = v[4] = v[6] = (v16qu){};
				ctx->f.mb_skip_flag |= get_ae(13 + 13 * ctx->slice_type -
					ctx->ctxIdxInc.mb_skip_flag);
				fprintf(stderr, "mb_skip_flag: %x\n", ctx->f.mb_skip_flag);
				parse_inter_mb();
			}
			
			// Point to the next macroblock
			ctx->s.decoded_mbs++;
			*ctx->flags++ = ctx->f_v;
			ctx->Intra4x4PredMode++;
			ctx->refIdx++;
			ctx->mvs += 2;
			ctx->absMvdComp++;
			ctx->x += 16;
			
			// Have we reached the end of a line?
			if (ctx->x == ctx->ps.width) {
				PicWidthInMbs = ctx->ps.width / 16;
				ctx->flags -= PicWidthInMbs;
				ctx->Intra4x4PredMode -= PicWidthInMbs + 4;
				ctx->refIdx -= PicWidthInMbs + 4;
				ctx->mvs -= PicWidthInMbs * 2 + 16;
				ctx->absMvdComp -= PicWidthInMbs + 8;
				ctx->x = 0;
				if ((ctx->y += 16) >= ctx->ps.height >> ctx->field_pic_flag)
					break;
			}
		} while (!get_ae(276));
	}
	codIRange = ctx->range;
	codIOffset = ctx->offset;
}
